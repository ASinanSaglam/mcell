#LyX 1.3 created this file. For more info see http://www.lyx.org/
\lyxformat 221
\textclass article
\begin_preamble
\raggedbottom
\widowpenalty=1000
\clubpenalty=1000
\def\need#1{\vskip0pt plus #1 \penalty-60 \vskip 0pt plus-#1\relax}
\end_preamble
\language english
\inputencoding auto
\fontscheme pslatex
\graphics default
\paperfontsize 10
\spacing single 
\papersize letterpaper
\paperpackage a4
\use_geometry 1
\use_amsmath 1
\use_natbib 0
\use_numerical_citations 0
\paperorientation portrait
\leftmargin 1in
\topmargin 1in
\rightmargin 1in
\bottommargin 1in
\headheight 0in
\headsep 0in
\footskip 0.5in
\secnumdepth 3
\tocdepth 3
\paragraph_separation skip
\defskip medskip
\quotes_language english
\quotes_times 2
\papercolumns 1
\papersides 1
\paperpagestyle default

\layout Title

MCell3 Quick Tutorial and Reference Guide
\layout Author

Rex Kerr
\layout Standard

In this document, the main text is in a serif font.
 Command-line entries, mdl file commands, and code is in a 
\family typewriter 
fixed-width
\family default 
 font.
 Values that must be supplied by the user are in an 
\family sans 
\shape italic 
italicized sans-serif
\family default 
\shape default 
 font.
\layout Standard

This document was created using LyX 1.3.4.
\layout Section

Running MCell3
\layout Standard

MCell3 runs on the command line.
 The format is
\layout Quotation


\family typewriter 
mcell3 
\family sans 
\shape italic 
options
\family typewriter 
\shape default 
 
\family sans 
\shape italic 
filename
\layout Standard

By default, MCell3 sends informational messages, such as simulation progress,
 to stdout (which will normally appear on the screen); error messages are
 sent to stderr (which will also normally appear on the screen).
 Results of simulations are written to files and do not appear as MCell3
 is running.
\layout Standard

A brief summary of MCell3 optional command-line arguments is given below.
\layout Standard


\begin_inset  Tabular
<lyxtabular version="3" rows="8" columns="2">
<features islongtable="true" headBottomDL="true">
<column alignment="left" valignment="top" leftline="true" width="0">
<column alignment="block" valignment="top" leftline="true" rightline="true" width="4in">
<row topline="true" bottomline="true" endhead="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\series bold 
Argument
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard


\series bold 
Explanation
\end_inset 
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
-seed 
\family sans 
\shape italic 
N
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Start with random number seed 
\family sans 
\shape italic 
N
\family default 
\shape default 
 instead of 1 (the default).
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
-iterations 
\family sans 
\shape italic 
N
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Run the simulation with 
\family sans 
\shape italic 
N
\family default 
\shape default 
 timesteps (overrides the value in the mdl file)
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
-help
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Print out a basic help screen.
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
-info
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Same as 
\family typewriter 
-help
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
-logfile 
\family sans 
\shape italic 
filename
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Send messages to 
\family sans 
\shape italic 
filename
\family default 
\shape default 
 instead of stdout/stderr
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
-logfreq 
\family sans 
\shape italic 
N
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Valid syntax, but not implemented yet.
\end_inset 
</cell>
</row>
<row topline="true" bottomline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
-checkpoint_infile 
\family sans 
\shape italic 
filename
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Use 
\family sans 
\shape italic 
filename
\family default 
\shape default 
 as a checkpoint file for the current simulation (overrides any value in
 the mdl file).
\end_inset 
</cell>
</row>
</lyxtabular>

\end_inset 


\layout Section

Model Description Language overview
\layout Standard

MCell3 runs simulations that are specified in 
\emph on 
model description language
\emph default 
 (mdl) format.
 These files typically have the extension .mdl, but are not required to.
 A mdl file is a text file with commands separated by whitespace.
 The nature and type of whitespace (space, tab, newline) is unimportant
 to MCell3.
 You are thus free to use whitespace to clarify the contents of the mdl
 file.
\layout Subsection

The structure of an MDL file
\layout Standard

Commands fall into five general groups, which usually should be given in
 the order presented below.
 Although this is not always required, there are some commands (e.g.
 defining a molecule) that must be used before others (e.g.
 defining a reaction that uses that molecule).
 The order below should always be safe:
\layout Enumerate

Initialization.
 These commands set global parameters such as the timestep, spatial partitioning
, and duration of the simulation.
\layout Enumerate

Molecule definitions.
 These commands specify the names and diffusion constants of molecules in
 the simulation.
\layout Enumerate

Reaction definitions.
 These commands specify the reactions that can occur between molecules and
 the rate at which those reactions occur.
\layout Enumerate

Geometry specification.
 These commands describe the membranes and other boundaries within which
 the simulation occurs, plus where in the world to place molecules initially.
\layout Enumerate

Output specification.
 These commands specify what data should be output as the simulation is
 running; this can include graphical snapshots of the simulation in progress,
 as well as lists of numbers of molecules or reactions as a function of
 time.
\layout Standard

In addition, there are utility commands--defining variables and including
 other mdl files--that can appear nearly anywhere.
\layout Subsection

How to use this document
\layout Standard

This document gives a brief description of every valid MCell3 command.
 Commands can be specified one after another; it is often convenient to
 put commands on separate lines but this is not necessary.
\layout Standard

Some commands have a scope, delimited by 
\family typewriter 
{
\family default 
 and 
\family typewriter 
}
\family default 
 (braces).
 Within these braces, a different set of commands become available.
 In this document, each set of commands is given a different title.
 For example, commands given within a 
\family typewriter 
DEFINE_MOLECULE
\family default 
 block receive the title Define Molecule Commands.
\layout Section

MDL commands
\layout Subsection

Initialization commands
\layout Standard

The following initialization commands are required in every mdl file.
\layout Standard


\begin_inset  Tabular
<lyxtabular version="3" rows="3" columns="2">
<features islongtable="true" headBottomDL="true">
<column alignment="left" valignment="top" leftline="true" width="2in">
<column alignment="left" valignment="top" leftline="true" rightline="true" width="4in">
<row topline="true" bottomline="true" endhead="true">
<cell alignment="block" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\series bold 
Command
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard


\series bold 
Explanation
\end_inset 
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
TIME_STEP = 
\family sans 
\shape italic 
t
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Set the simulation time step to 
\family sans 
\shape italic 
t
\family default 
\shape default 
 seconds.
 
\family typewriter 
1e-6
\family default 
 is a common value.
 Later commands can change the time steps taken by individual molecules,
 but this time step is still used by all output statements.
\end_inset 
</cell>
</row>
<row topline="true" bottomline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
ITERATIONS = 
\family sans 
\shape italic 
N
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Run the simulation for 
\family sans 
\shape italic 
N
\family default 
\shape default 
 iterations.
\end_inset 
</cell>
</row>
</lyxtabular>

\end_inset 


\layout Standard

The following initialization commands are optional.
\layout Standard


\begin_inset  Tabular
<lyxtabular version="3" rows="11" columns="2">
<features islongtable="true" headBottomDL="true">
<column alignment="left" valignment="top" leftline="true" width="0">
<column alignment="left" valignment="top" leftline="true" rightline="true" width="4in">
<row topline="true" bottomline="true" endhead="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\series bold 
Command
\end_inset 
</cell>
<cell alignment="block" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard


\series bold 
Explanation
\end_inset 
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
TIME_STEP_MAX = 
\family sans 
\shape italic 
t
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

MCell3 will move longer than the specified simulation time step if it seems
 safe.
 This command makes sure that the longest possible time step is no longer
 than 
\family sans 
\shape italic 
t
\family default 
\shape default 
 seconds, even if MCell3 thinks a longer step would be safe.
 The default is no limit.
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
SPACE_STEP = 
\family sans 
\shape italic 
N
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Have all diffusing molecules take time steps of different duration, chosen
 so that the mean diffusion distance is 
\family sans 
\shape italic 
N
\family default 
\shape default 
 microns for each molecule.
 By default, all molecules move the same time step.
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
EFFECTOR_GRID_DENSITY = 
\family sans 
\shape italic 
N
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Tile all surfaces so that they can hold molecules at 
\family sans 
\shape italic 
N
\family default 
\shape default 
 different positions per square micron.
 The default is 10000.
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
INTERACTION_RADIUS = 
\family sans 
\shape italic 
N
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Diffusing molecules will interact with each other when they get within 
\family sans 
\shape italic 
N
\family default 
\shape default 
 microns of each other.
 The default is 0.01.
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
PARTITION_
\family sans 
\shape italic 
D
\family typewriter 
\shape default 
 = [
\family sans 
\shape italic 
list
\family typewriter 
\shape default 
]
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Subdivide the 
\family sans 
\shape italic 
D
\family default 
\shape default 
'th axis of space, where 
\family sans 
\shape italic 
D
\family default 
\shape default 
 is 
\family typewriter 
X
\family default 
, 
\family typewriter 
Y
\family default 
, or 
\family typewriter 
Z
\family default 
, at the boundaries given in 
\family sans 
\shape italic 
list
\family default 
\shape default 
 (in microns).
 In future versions, MCell3 will further subdivide space if it is computationall
y advantageous.
 By default, each axis will be split into between five and fifteen equal
 partitions.
 If you do not explicitly partition all three axes, MCell3 is likely to
 ignore your request and perform automatic partitioning.
 The spacing between adjacent partitions must be larger than the 
\family typewriter 
INTERACTION_RADIUS
\family default 
.
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
RADIAL_DIRECTIONS = 
\family sans 
\shape italic 
N
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Specifies how many different directions to put in the lookup table.
 The default is sensible.
 Don't use this unless you know what you're doing.
 Instead of a number, you can specify 
\family typewriter 
FULLY_RANDOM
\family default 
 to generate the directions directly from double precision numbers (but
 this is slower).
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
RADIAL_SUBDIVISIONS = 
\family sans 
\shape italic 
N
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Specifies how many distances to put in the diffusion lookup table.
 Again, the default is sensible.
 
\family typewriter 
FULLY_RANDOM
\family default 
 is not implemented here.
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
ACCURATE_3D_REACTIONS = 
\family sans 
\shape italic 
boolean
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Specifies which method to use for computing 3D molecule-molecule interactions.
 If 
\family sans 
\shape italic 
boolean
\family default 
\shape default 
 is 
\family typewriter 
TRUE
\family default 
, then molecules will look through partition boundaries for potential interactin
g partners--this is slower but more accurate.
 If 
\family sans 
\shape italic 
boolean
\family default 
\shape default 
 is 
\family typewriter 
FALSE
\family default 
, then molecule interaction disks will be clipped at partition boundaries
 and probabilities adjusted to get the correct rate--this is faster but
 can be less accurate.
 The default is 
\family typewriter 
TRUE
\family default 
.
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
CENTER_MOLECULES_ON_GRID = 
\family sans 
\shape italic 
boolean
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

If 
\family sans 
\shape italic 
boolean
\family default 
\shape default 
 is set to 
\family typewriter 
TRUE
\family default 
, then all molecules on a surface will be located exactly at the center
 of their grid element.
 If 
\family typewriter 
FALSE
\family default 
, the molecules will be randomly located when placed, and reactions will
 take place at the location of the target (or the site of impact in the
 case of 3D molecule/surface reactions).
 The default is currently 
\family typewriter 
TRUE
\family default 
, but this should probably be changed.
\end_inset 
</cell>
</row>
<row topline="true" bottomline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
VACANCY_SEARCH_DISTANCE = 
\family sans 
\shape italic 
r
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Normally, a reaction will not proceed on a surface unless there is room
 to place all products on the single grid element where the reaction is
 initiated.
 By increasing 
\family sans 
\shape italic 
r
\family default 
\shape default 
 from its default value of 0, one can specify how far from the reaction's
 location, in microns, the reaction can place its products.
 To be useful, 
\family sans 
\shape italic 
r
\family default 
\shape default 
 must be larger than the longest axis of the grid element on the triangle
 in question.
 The reaction will then proceed if there is room to place its products within
 a radius 
\family sans 
\shape italic 
r
\family default 
\shape default 
, and will place those products as close as possible to the place where
 the reaction occurs (deterministically, so small-scale directional bias
 is possible).
\end_inset 
</cell>
</row>
</lyxtabular>

\end_inset 


\layout Subsection

Molecule definition commands
\layout Standard

All molecules must be defined by name in a 
\family typewriter 
DEFINE_MOLECULES
\family default 
 block.
 For users of MCell 2, note that there is no longer a distinction between
 a receptor and a ligand.
 Everything is a molecule, and every different bound state of a receptor
 must have a unique name (since it must be a unique molecule).
 The names must be unique in the entire simulation (that is, unique within
 their own MDL file and any included MDL files that make up the whole simulation
).
\layout Standard

A define molecule block can be one of the following:
\layout Standard


\begin_inset  Tabular
<lyxtabular version="3" rows="3" columns="2">
<features islongtable="true" headBottomDL="true">
<column alignment="left" valignment="top" leftline="true" width="0">
<column alignment="block" valignment="top" leftline="true" rightline="true" width="55col%">
<row topline="true" bottomline="true" endhead="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\series bold 
Command
\end_inset 
</cell>
<cell multicolumn="1" alignment="block" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none" width="60col%">
\begin_inset Text

\layout Standard


\series bold 
Explanation
\end_inset 
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 

\begin_inset Minipage
position 0
inner_position 0
height "0pt"
width "35col%"
collapsed false

\layout Standard


\family typewriter 
DEFINE_MOLECULE 
\family sans 
\shape italic 
name
\layout Standard


\family typewriter 
{
\layout Standard


\family sans 
\shape italic 
\SpecialChar ~
\SpecialChar ~
define molecule commands
\family typewriter 
\shape default 
 
\layout Standard


\family typewriter 
}
\begin_inset ERT
status Collapsed

\layout Standard

\backslash 
vspace{3pt}
\end_inset 


\end_inset 


\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Define a single molecule called 
\family sans 
\shape italic 
name
\family default 
\shape default 
.
 The molecule's properties are specified by commands inside braces.
\end_inset 
</cell>
</row>
<row topline="true" bottomline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 

\begin_inset Minipage
position 0
inner_position 0
height "0pt"
width "35col%"
collapsed false

\layout Standard


\family typewriter 
DEFINE_MOLECULES
\layout Standard


\family typewriter 
{
\layout Standard


\family sans 
\shape italic 
\SpecialChar ~
\SpecialChar ~
nameA
\family typewriter 
\shape default 
 { 
\family sans 
\shape italic 
define molecule commands
\family typewriter 
\shape default 
 }
\layout Standard


\family sans 
\shape italic 
\SpecialChar ~
\SpecialChar ~
nameB
\family typewriter 
\shape default 
 { 
\family sans 
\shape italic 
define molecule commands
\family typewriter 
\shape default 
 }
\layout Standard


\family sans 
\shape italic 
\SpecialChar ~
\SpecialChar ~
...
\layout Standard


\family typewriter 
}
\begin_inset ERT
status Collapsed

\layout Standard

\backslash 
vspace{3pt}
\end_inset 


\end_inset 


\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Define a series of molecules by name.
 Each molecule's properties are specified by commands inside braces.
\end_inset 
</cell>
</row>
</lyxtabular>

\end_inset 


\layout Standard

Each molecule must have a diffusion constant set using one of the following
 commands:
\layout Standard


\begin_inset  Tabular
<lyxtabular version="3" rows="3" columns="2">
<features islongtable="true" headBottomDL="true">
<column alignment="left" valignment="top" leftline="true" width="0">
<column alignment="left" valignment="top" leftline="true" rightline="true" width="4in">
<row topline="true" bottomline="true" endhead="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\series bold 
Define Molecule Command
\end_inset 
</cell>
<cell alignment="block" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard


\series bold 
Explanation
\end_inset 
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
DIFFUSION_CONSTANT = 
\family sans 
\shape italic 
D
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

This molecule diffuses in space with diffusion constant 
\family sans 
\shape italic 
D
\family default 
\shape default 
.
 
\family sans 
\shape italic 
D
\family default 
\shape default 
 can be zero, in which case the molecule doesn't move.
 Synonyms for this command are 
\family typewriter 
DIFFUSION_CONSTANT_3D
\family default 
 and 
\family typewriter 
D_3D
\family default 
.
 The units of 
\family sans 
\shape italic 
D
\family default 
\shape default 
 are 
\begin_inset Formula $\mathrm{{cm}^{2}/\mathrm{{s}}}$
\end_inset 

.
\end_inset 
</cell>
</row>
<row topline="true" bottomline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
DIFFUSION_CONSTANT_2D = 
\family sans 
\shape italic 
D
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

This molecule is constrained to a surface and diffuses with diffusion constant
 
\family sans 
\shape italic 
D
\family default 
\shape default 
.
 Until surface diffusion is implemented, only 
\family typewriter 
0
\family default 
 is a valid value for 
\family sans 
\shape italic 
D
\family default 
\shape default 
.
 
\family typewriter 
D_2D
\family default 
 is a synonym for this command.
\end_inset 
</cell>
</row>
</lyxtabular>

\end_inset 


\layout Standard

The following optional commands can be applied to each molecule (and must
 appear in this order, and after the diffusion constant is set):
\layout Standard


\begin_inset  Tabular
<lyxtabular version="3" rows="4" columns="2">
<features islongtable="true" headBottomDL="true">
<column alignment="left" valignment="top" leftline="true" width="0">
<column alignment="left" valignment="top" leftline="true" rightline="true" width="4in">
<row topline="true" bottomline="true" endhead="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\series bold 
Define Molecule Command
\end_inset 
</cell>
<cell alignment="block" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard


\series bold 
Explanation
\end_inset 
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
CUSTOM_TIME_STEP = 
\family sans 
\shape italic 
t
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

This molecule should take timesteps of length 
\family sans 
\shape italic 
t
\family default 
\shape default 
 (in seconds).
 Use either this or 
\family typewriter 
CUSTOM_SPACE_STEP
\family default 
, not both.
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
CUSTOM_SPACE_STEP = 
\family sans 
\shape italic 
L
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

This molecule should take steps of average length 
\family sans 
\shape italic 
L
\family default 
\shape default 
 (in microns).
 If you use this directive, do not set 
\family typewriter 
CUSTOM_TIME_STEP
\family default 
.
\end_inset 
</cell>
</row>
<row topline="true" bottomline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
TARGET_ONLY
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

This molecule will not initiate reactions when it runs into other molecules.
 This setting can speed up simulations when applied to a molecule at high
 concentrations that reacts with a molecule at low concentrations (it is
 more efficient for the low-concentration molecule to trigger the reactions).
 This directive does not affect unimolecular reactions.
\end_inset 
</cell>
</row>
</lyxtabular>

\end_inset 


\layout Subsection

Reaction definition commands
\layout Standard

All reactions must be defined inside a reaction definition block:
\layout Standard


\begin_inset  Tabular
<lyxtabular version="3" rows="2" columns="2">
<features islongtable="true" headBottomDL="true">
<column alignment="left" valignment="top" leftline="true" width="0">
<column alignment="block" valignment="top" leftline="true" rightline="true" width="4in">
<row topline="true" bottomline="true" endhead="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\series bold 
Command
\end_inset 
</cell>
<cell multicolumn="1" alignment="block" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard


\series bold 
Explanation
\end_inset 
</cell>
</row>
<row bottomline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\begin_inset Minipage
position 0
inner_position 0
height "0pt"
width "35col%"
collapsed false

\layout Standard


\family typewriter 
DEFINE_REACTIONS
\layout Standard


\family typewriter 
{
\layout Standard


\family sans 
\shape italic 
\SpecialChar ~
\SpecialChar ~
reaction commands
\layout Standard


\family typewriter 
}
\begin_inset ERT
status Collapsed

\layout Standard

\backslash 
vspace{3pt}
\end_inset 


\end_inset 


\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Define a series of reactions inside braces.
\end_inset 
</cell>
</row>
</lyxtabular>

\end_inset 


\layout Standard

Reactions are specified using arrow notation:
\layout Standard


\begin_inset  Tabular
<lyxtabular version="3" rows="3" columns="2">
<features islongtable="true" headBottomDL="true">
<column alignment="left" valignment="top" leftline="true" width="0">
<column alignment="block" valignment="top" leftline="true" rightline="true" width="4in">
<row topline="true" bottomline="true" endhead="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\series bold 
Reaction Command
\end_inset 
</cell>
<cell multicolumn="1" alignment="block" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard


\series bold 
Explanation
\end_inset 
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family sans 
\shape italic 
reactants
\family typewriter 
\shape default 
 -> 
\family sans 
\shape italic 
products
\family typewriter 
\shape default 
 [
\family sans 
\shape italic 
rate
\family typewriter 
\shape default 
]
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Define a reaction that occurs between one or two 
\family sans 
\shape italic 
reactants
\family default 
\shape default 
 and produces an arbitrary number of 
\family sans 
\shape italic 
products
\family default 
\shape default 
, with a specified 
\family sans 
\shape italic 
rate
\family default 
\shape default 
.
 If a molecule is in the 
\family sans 
\shape italic 
reactants
\family default 
\shape default 
 list and not in the 
\family sans 
\shape italic 
products
\family default 
\shape default 
 list, it is destroyed in the reaction.
 One reactant may be a surface type (see section 
\begin_inset LatexCommand \ref{sec_surfprop}

\end_inset 

).
 
\emph on 
!!
\emph default 
Need to describe rates from files
\emph on 
!!
\end_inset 
</cell>
</row>
<row topline="true" bottomline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family sans 
\shape italic 
reactants
\family typewriter 
\shape default 
 -> 
\family sans 
\shape italic 
products
\family typewriter 
\shape default 
 [
\family sans 
\shape italic 
rate
\family typewriter 
\shape default 
]:
\family sans 
\shape italic 
name
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

As above, and call the reaction 
\family sans 
\shape italic 
name
\family default 
\shape default 
 so it can be referred to by count statements.
\end_inset 
</cell>
</row>
</lyxtabular>

\end_inset 


\layout Standard

This notation is perhaps best explained through examples.
 In the most basic form, reactants and products are just the names of molecules,
 separated by 
\family typewriter 
+
\family default 
:
\layout Standard


\begin_inset  Tabular
<lyxtabular version="3" rows="6" columns="2">
<features islongtable="true" headBottomDL="true">
<column alignment="left" valignment="top" leftline="true" width="0">
<column alignment="block" valignment="top" leftline="true" rightline="true" width="4in">
<row topline="true" bottomline="true" endhead="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\series bold 
Example
\end_inset 
</cell>
<cell multicolumn="1" alignment="block" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard


\series bold 
Explanation
\end_inset 
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
A -> B [100]
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Molecule 
\family typewriter 
A
\family default 
 changes into molecule 
\family typewriter 
B
\family default 
 at a rate of 
\begin_inset Formula $100\,\mathrm{{s}^{-1}}$
\end_inset 

.
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
A -> A + B [100]
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Molecule 
\family typewriter 
A
\family default 
 emits molecules of 
\family typewriter 
B
\family default 
 at a rate of 
\begin_inset Formula $100\,\mathrm{{s}^{-1}}$
\end_inset 

.
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
A + B -> A [1e6]
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Molecule 
\family typewriter 
A
\family default 
 destroys molecule 
\family typewriter 
B
\family default 
 at a rate of 
\begin_inset Formula $10^{6}\,\mathrm{{M}}^{-1}\cdot\mathrm{{s}^{-1}}$
\end_inset 

.
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
A + B -> A + C [1e6]
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Molecule 
\family typewriter 
A
\family default 
 catalytically converts 
\family typewriter 
B
\family default 
 to 
\family typewriter 
C
\family default 
 at a rate of 
\begin_inset Formula $10^{6}\,\mathrm{{M}}^{-1}\cdot\mathrm{{s}^{-1}}$
\end_inset 

.
\end_inset 
</cell>
</row>
<row topline="true" bottomline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
A+B -> A+B+C [1e6]
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Collision of 
\family typewriter 
A
\family default 
 and 
\family typewriter 
B
\family default 
 catalytically generates 
\family typewriter 
C
\family default 
 at a rate of 
\begin_inset Formula $10^{6}\,\mathrm{{M}}^{-1}\cdot\mathrm{{s}^{-1}}$
\end_inset 

.
\end_inset 
</cell>
</row>
</lyxtabular>

\end_inset 


\layout Standard

Orientation classes are a fundamentally new concept introduced in MCell3.
 They replace the MCell 2 idea of 
\family typewriter 
POSITIVE_POLE
\family default 
, 
\family typewriter 
NEGATIVE_POLE
\family default 
, and 
\family typewriter 
BOTH_POLES
\family default 
 specifications for receptors.
\layout Standard

Molecules in a surface have an orientation: up if they point in the direction
 of the surface normal, down otherwise..
 Molecules in 3D that strike or come off a surface also have an orientation:
 up if the surface normal points towards them, down if it points away.
\layout Standard

Reactions normally do not specify absolute orientation.
 Instead, a reaction lists the required relative orientation of the reactants,
 and specifies the relative orientation of the products.
 This allows you to write general reactions that do not depend on the direction
 of insertion of a molecule into a membrane.
\layout Standard

The two orientations are specified by 
\family typewriter 
'
\family default 
 and 
\family typewriter 
,
\family default 
 (apostrophe and comma) after the molecule's name.
 For example, a surface-bound molecule 
\family typewriter 
B
\family default 
 has the orientations 
\family typewriter 
B'
\family default 
 and 
\family typewriter 
B,
\family default 
.
 For example:
\layout Standard


\begin_inset  Tabular
<lyxtabular version="3" rows="4" columns="2">
<features islongtable="true" headBottomDL="true">
<column alignment="left" valignment="top" leftline="true" width="0">
<column alignment="block" valignment="top" leftline="true" rightline="true" width="4in">
<row topline="true" bottomline="true" endhead="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\series bold 
Example
\end_inset 
</cell>
<cell multicolumn="1" alignment="block" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard


\series bold 
Explanation
\end_inset 
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
B' -> B, [10]
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Molecule 
\family typewriter 
B
\family default 
 flips (changes its orientation) at a rate of 
\begin_inset Formula $10\mathrm{{s}^{-1}}$
\end_inset 

.
\end_inset 
</cell>
</row>
<row topline="true" bottomline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
B' -> B' + A' + C, [10]
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Molecule 
\family typewriter 
B
\family default 
 emits molecules of 
\family typewriter 
A
\family default 
 on the side it's pointing to and emits 
\family typewriter 
C
\family default 
 on the other side, at a rate of 
\begin_inset Formula $10\mathrm{{s}^{-1}}$
\end_inset 


\end_inset 
</cell>
</row>
<row bottomline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
B, -> B, + A, + C' [10]
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

This specifies exactly the same reaction as above.
 
\family typewriter 
B
\family default 
 and 
\family typewriter 
A
\family default 
 end up with the same orientation, while 
\family typewriter 
C
\family default 
 has opposite orientation.
\end_inset 
</cell>
</row>
</lyxtabular>

\end_inset 


\layout Standard

The best way to keep the relationships straight is to draw a 
\begin_inset Quotes eld
\end_inset 

before
\begin_inset Quotes erd
\end_inset 

 picture with each reactant facing the direction of the tick mark, and an
 
\begin_inset Quotes eld
\end_inset 

after
\begin_inset Quotes erd
\end_inset 

 picture with each product facing in the direction of the tick mark.
 Since you can always turn your picture upside-down and still have the same
 picture, you can also always flip all tick marks and get the same reaction.
 You can thus use tick marks that are consistent with your mental picture.
\layout Standard

If 
\family typewriter 
A
\family default 
 diffuses in 3D but 
\family typewriter 
B
\family default 
 and 
\family typewriter 
C
\family default 
 are on a surface:
\layout Standard


\begin_inset  Tabular
<lyxtabular version="3" rows="5" columns="2">
<features islongtable="true" headBottomDL="true">
<column alignment="left" valignment="top" leftline="true" width="0">
<column alignment="block" valignment="top" leftline="true" rightline="true" width="4in">
<row topline="true" bottomline="true" endhead="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\series bold 
Example
\end_inset 
</cell>
<cell multicolumn="1" alignment="block" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard


\series bold 
Explanation
\end_inset 
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
A' + B' -> C' [1e5]
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Molecule 
\family typewriter 
A
\family default 
 binds to 
\family typewriter 
B
\family default 
 if it is on the side that 
\family typewriter 
B
\family default 
 is pointing to, producing a 
\family typewriter 
C
\family default 
 facing the same way as 
\family typewriter 
B
\family default 
, at a rate of 
\begin_inset Formula $10^{5}\,\mathrm{{M}}^{-1}\cdot\mathrm{{s}^{-1}}$
\end_inset 

.
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
A, + B, -> C, [1e5]
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

The same reaction again---everything occurs on the same side, but we wrote
 it on the bottom this time.
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
A' + B, -> C' [1e5]
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Molecule 
\family typewriter 
A
\family default 
 binds when it hits the opposite side of 
\family typewriter 
B
\family default 
, producing a 
\family typewriter 
C
\family default 
 facing the opposite way as 
\family typewriter 
B
\family default 
 (i.e.
 towards the side 
\family typewriter 
A
\family default 
 came from), at a rate of 
\begin_inset Formula $10^{5}\,\mathrm{{M}}^{-1}\cdot\mathrm{{s}^{-1}}$
\end_inset 

.
\end_inset 
</cell>
</row>
<row topline="true" bottomline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
A, + B' -> C, [1e5]
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Same as above.
\end_inset 
</cell>
</row>
</lyxtabular>

\end_inset 


\layout Standard

So far, all examples have used the first orientation class, specified with
 
\family typewriter 
'
\family default 
 and 
\family typewriter 
,
\family default 
.
 The second orientation class is specified by 
\begin_inset Formula $\texttt{{'}{'}}$
\end_inset 

 and 
\begin_inset Formula $\texttt{{,}{,}}$
\end_inset 

.
 The third is 
\begin_inset Formula $\texttt{{'}{'}{'}}$
\end_inset 

 and 
\begin_inset Formula $\texttt{{,}{,}{,}}$
\end_inset 

 and so on.
 A molecule can be in only one orientation class, and molecules in different
 classes do not pay attention to each others' orientation.
 In a reaction where orientation may be a factor, every molecule must be
 explicitly given an orientation class.
 Therefore:
\begin_inset  Tabular
<lyxtabular version="3" rows="8" columns="2">
<features islongtable="true" headBottomDL="true">
<column alignment="left" valignment="top" leftline="true" width="0">
<column alignment="block" valignment="top" leftline="true" rightline="true" width="4in">
<row topline="true" bottomline="true" endhead="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\series bold 
Example
\end_inset 
</cell>
<cell multicolumn="1" alignment="block" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard


\series bold 
Explanation
\end_inset 
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
A
\family default 

\begin_inset Formula $\texttt{{'}{'}}$
\end_inset 


\family typewriter 
 + B, -> C' [1e5]
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Molecule 
\family typewriter 
A
\family default 
 binds to either side of 
\family typewriter 
B
\family default 
 (since they are in different orientation classes); this produces a 
\family typewriter 
C
\family default 
 facing the opposite way as 
\family typewriter 
B
\family default 
, at a rate of 
\begin_inset Formula $10^{5}\,\mathrm{{M}}^{-1}\cdot\mathrm{{s}^{-1}}$
\end_inset 

.
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
A
\begin_inset Formula ${,}{,}$
\end_inset 

 + B, -> C' [1e5]
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

This is the same reaction---since 
\family typewriter 
A
\family default 
 is the only molecule in the second orientation class, it doesn't matter
 which way we specify things.
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
A
\begin_inset Formula ${,}{,}$
\end_inset 

 + B' -> C, [1e5]
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Same again--
\family typewriter 
B
\family default 
 and 
\family typewriter 
C
\family default 
 still have opposite orientations.
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
A, + B' -> C
\begin_inset Formula ${,}{,}$
\end_inset 

 [1e5]
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Molecule 
\family typewriter 
A
\family default 
 hits the opposite side of 
\family typewriter 
B
\family default 
 and produces 
\family typewriter 
C
\family default 
 that is equally likely to point either way, at a rate of 
\begin_inset Formula $10^{5}\,\mathrm{{M}}^{-1}\cdot\mathrm{{s}^{-1}}$
\end_inset 

.
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
A, + B' -> C
\family default 

\begin_inset Formula $\texttt{{'}{'}}$
\end_inset 


\family typewriter 
 [1e5]
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Same as above, since 
\family typewriter 
C
\family default 
 is still not in the same orientation class as the others.
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
A'+B
\family default 

\begin_inset Formula $\texttt{{'}{'}}$
\end_inset 


\family typewriter 
 -> A,+B
\family default 

\begin_inset Formula $\texttt{{'}{'}{'}}$
\end_inset 


\family typewriter 
 [1e5]
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Molecule 
\family typewriter 
A
\family default 
 hits molecule 
\family typewriter 
B
\family default 
 on either side; 
\family typewriter 
A
\family default 
 keeps traveling (goes to the other side) and 
\family typewriter 
B
\family default 
 to tumbles to a random orientation, at a rate of 
\begin_inset Formula $10^{5}\,\mathrm{{M}}^{-1}\cdot\mathrm{{s}^{-1}}$
\end_inset 

.
\end_inset 
</cell>
</row>
<row topline="true" bottomline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
A'+B
\family default 

\begin_inset Formula $\texttt{{'}{'}}$
\end_inset 


\family typewriter 
 -> C
\family default 

\begin_inset Formula $\texttt{{'}{'}{'}}$
\end_inset 


\family typewriter 
+D
\family default 

\begin_inset Formula $\texttt{{'}{'}{'}{'}}$
\end_inset 


\family typewriter 
 [1e5]
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
A
\family default 
 and 
\family typewriter 
B
\family default 
 react in any orientation and produce 
\family typewriter 
C
\family default 
 and 
\family typewriter 
D
\family default 
 in random orientations.
 All orientation classes are different, so there are no geometrical constraints
 here.
\end_inset 
</cell>
</row>
</lyxtabular>

\end_inset 


\layout Standard

There are examples of how one would use this syntax to model well-known
 biological reactions at the end of this file.
\layout Standard


\emph on 
Need to add code and syntax to specify a surface with an orientation also.
\layout Subsection

Geometry definition commands
\layout Subsubsection

Surface properties
\begin_inset LatexCommand \label{sec_surfprop}

\end_inset 


\layout Standard

MCell3 allows the user to specify properties of the surfaces of objects.
 For example, one may wish to specify that a surface does not block the
 diffusion of molecules.
 Each type of surface is defined by name, and each surface name must be
 unique in the simulation and should not match any molecule names.
 Surface properties are specified inside a surface definition block:
\layout Standard


\begin_inset  Tabular
<lyxtabular version="3" rows="3" columns="2">
<features islongtable="true" headBottomDL="true">
<column alignment="left" valignment="top" leftline="true" width="0">
<column alignment="block" valignment="top" leftline="true" rightline="true" width="4in">
<row topline="true" bottomline="true" endhead="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\series bold 
Command
\end_inset 
</cell>
<cell multicolumn="1" alignment="block" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard


\series bold 
Explanation
\end_inset 
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\begin_inset Minipage
position 0
inner_position 0
height "0pt"
width "35col%"
collapsed false

\layout Standard


\family typewriter 
DEFINE_SURFACE_CLASS 
\family sans 
\shape italic 
name
\family typewriter 
\shape default 
 
\layout Standard


\family typewriter 
{
\layout Standard


\family sans 
\shape italic 
\SpecialChar ~
\SpecialChar ~
surface property commands
\layout Standard


\family typewriter 
}
\begin_inset ERT
status Collapsed

\layout Standard

\backslash 
vspace{3pt}
\end_inset 


\end_inset 


\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Define a single surface type called 
\family sans 
\shape italic 
name
\family default 
\shape default 
.
 The properties are specified by commands inside braces.
\end_inset 
</cell>
</row>
<row topline="true" bottomline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\begin_inset Minipage
position 0
inner_position 0
height "0pt"
width "35col%"
collapsed false

\layout Standard


\family typewriter 
DEFINE_SURFACE_CLASSES
\layout Standard


\family typewriter 
{
\layout Standard


\family sans 
\shape italic 
\SpecialChar ~
\SpecialChar ~
nameA
\family typewriter 
\shape default 
 { 
\family sans 
\shape italic 
surface property commands
\family typewriter 
\shape default 
 }
\layout Standard


\family sans 
\shape italic 
\SpecialChar ~
\SpecialChar ~
nameB
\family typewriter 
\shape default 
 { 
\family sans 
\shape italic 
surface property commands
\family typewriter 
\shape default 
 }
\layout Standard


\family sans 
\shape italic 
\SpecialChar ~
\SpecialChar ~
...
\layout Standard


\family typewriter 
}
\begin_inset ERT
status Collapsed

\layout Standard

\backslash 
vspace{3pt}
\end_inset 


\end_inset 


\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Define a series of surface types by name.
\end_inset 
</cell>
</row>
</lyxtabular>

\end_inset 


\layout Standard

To define surface properties, use the following commands:
\layout Standard


\begin_inset  Tabular
<lyxtabular version="3" rows="6" columns="2">
<features islongtable="true" headBottomDL="true">
<column alignment="left" valignment="top" leftline="true" width="0">
<column alignment="block" valignment="top" leftline="true" rightline="true" width="4in">
<row topline="true" bottomline="true" endhead="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\series bold 
Surface Property Command
\end_inset 
</cell>
<cell multicolumn="1" alignment="block" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard


\series bold 
Explanation
\end_inset 
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
REFLECTIVE = 
\family sans 
\shape italic 
name
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

The molecule called 
\family sans 
\shape italic 
name
\family default 
\shape default 
 is reflected by this surface.
 This is the default behavior.
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
TRANSPARENT = 
\family sans 
\shape italic 
name
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

The molecule called 
\family sans 
\shape italic 
name
\family default 
\shape default 
 passes through this surface.
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
ABSORPTIVE = 
\family sans 
\shape italic 
name
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

The molecule called 
\family sans 
\shape italic 
name
\family default 
\shape default 
 is destroyed if it touches this surface.
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\begin_inset Minipage
position 0
inner_position 0
height "0pt"
width "30col%"
collapsed false

\layout Standard


\family typewriter 
MOLECULE_DENSITY
\layout Standard


\family typewriter 
{
\layout Standard


\family sans 
\shape italic 
\SpecialChar ~
\SpecialChar ~
name1
\family typewriter 
\shape default 
 = 
\family sans 
\shape italic 
D1
\layout Standard


\family sans 
\shape italic 
\SpecialChar ~
\SpecialChar ~
name2
\family typewriter 
\shape default 
 = 
\family sans 
\shape italic 
D2
\layout Standard


\family sans 
\shape italic 
\SpecialChar ~
\SpecialChar ~
...
\layout Standard


\family typewriter 
}
\begin_inset ERT
status Collapsed

\layout Standard

\backslash 
vspace{3pt}
\end_inset 


\end_inset 


\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Add the named molecules at the specified densities 
\family sans 
\shape italic 
D1
\family default 
\shape default 
, 
\family sans 
\shape italic 
D2
\family default 
\shape default 
, 
\family sans 
\shape italic 
...
\family default 
\shape default 
, (units = 
\begin_inset Formula $\mu\mathrm{{m}}^{-2}$
\end_inset 

) to every surface with this surface class.
 Use orientation marks after the name to specify the direction relative
 to the surface normal.
 For example, 
\family typewriter 
A'
\family default 
 specifies a molecule in the same orientation as the surface, while 
\family typewriter 
A,
\family default 
 specifies the opposite orientation.
\end_inset 
</cell>
</row>
<row topline="true" bottomline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\begin_inset Minipage
position 0
inner_position 0
height "0pt"
width "30col%"
collapsed false

\layout Standard


\family typewriter 
MOLECULE_NUMBER
\layout Standard


\family typewriter 
{
\layout Standard


\family sans 
\shape italic 
\SpecialChar ~
\SpecialChar ~
name1
\family typewriter 
\shape default 
 = 
\family sans 
\shape italic 
N1
\layout Standard


\family sans 
\shape italic 
\SpecialChar ~
\SpecialChar ~
name2
\family typewriter 
\shape default 
 = 
\family sans 
\shape italic 
N2
\layout Standard


\family sans 
\shape italic 
\SpecialChar ~
\SpecialChar ~
...
\layout Standard


\family typewriter 
}
\begin_inset ERT
status Collapsed

\layout Standard

\backslash 
vspace{3pt}
\end_inset 


\end_inset 


\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Add the exact numbers 
\family sans 
\shape italic 
N1
\family default 
\shape default 
, 
\family sans 
\shape italic 
N2
\family default 
\shape default 
, 
\family sans 
\shape italic 
...
\family default 
\shape default 
, of molecules onto any region that is made out of this surface class.
 Note: this usage is not recommended; it is better to add exact numbers
 of molecules to the region.
 Orientation marks after the name must be used to specify the direction
 the molecules are facing.
\end_inset 
</cell>
</row>
</lyxtabular>

\end_inset 


\layout Standard

Note that surface normals are defined by the right-hand rule applied to
 the vertices in order as listed (see section 
\begin_inset LatexCommand \ref{geom_obj}

\end_inset 

).
 Box objects are converted internally into triangles and the surface normals
 point outwards.
\layout Subsubsection


\begin_inset LatexCommand \label{geom_obj}

\end_inset 

Geometrical objects
\layout Standard

Two types of geometrical objects are supported in MCell3.
 Objects should not have coincident surfaces unless neither surface contains
 a molecule that any moving molecule can react with.
 Also, all coincident surfaces should agree on whether they are transparent,
 reflective, or absorptive to each molecule that might strike them.
 Geometrical objects can be defined using:
\layout Standard


\begin_inset  Tabular
<lyxtabular version="3" rows="3" columns="2">
<features islongtable="true" headBottomDL="true">
<column alignment="left" valignment="top" leftline="true" width="0">
<column alignment="block" valignment="top" leftline="true" rightline="true" width="4in">
<row topline="true" bottomline="true" endhead="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\series bold 
Command
\end_inset 
</cell>
<cell multicolumn="1" alignment="block" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard


\series bold 
Explanation
\end_inset 
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\begin_inset Minipage
position 0
inner_position 0
height "0pt"
width "30col%"
collapsed false

\layout Standard


\family sans 
\shape italic 
name
\family typewriter 
\shape default 
 BOX
\layout Standard


\family typewriter 
{
\layout Standard


\family sans 
\shape italic 
\SpecialChar ~
\SpecialChar ~
box commands
\layout Standard


\family sans 
\shape italic 
\SpecialChar ~
\SpecialChar ~
region commands
\layout Standard


\family sans 
\shape italic 
\SpecialChar ~
\SpecialChar ~
transformation commands
\family typewriter 
\shape default 
 
\layout Standard


\family typewriter 
}
\end_inset 


\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

This defines a box object called 
\family sans 
\shape italic 
name
\family default 
\shape default 
.
 The shape and position of the box is defined by .
 Optionally, additional commands can create regions and perform geometrical
 transformations on the box.
 Internally, a box is represented as a set of triangles.
\end_inset 
</cell>
</row>
<row topline="true" bottomline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\begin_inset Minipage
position 0
inner_position 0
height "0pt"
width "30col%"
collapsed false

\layout Standard


\family sans 
\shape italic 
name
\family typewriter 
\shape default 
 POLYGON_LIST
\layout Standard


\family typewriter 
{
\layout Standard


\family sans 
\shape italic 
\SpecialChar ~
\SpecialChar ~
polygon commands
\layout Standard


\family sans 
\shape italic 
\SpecialChar ~
\SpecialChar ~
region commands
\layout Standard


\family sans 
\shape italic 
\SpecialChar ~
\SpecialChar ~
transformation commands
\family typewriter 
\shape default 
 
\layout Standard


\family typewriter 
}
\end_inset 


\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

This defines a polygon list object called 
\family sans 
\shape italic 
name
\family default 
\shape default 
.
 Polygon list objects explicitly give their triangular surface elements.
\end_inset 
</cell>
</row>
</lyxtabular>

\end_inset 


\layout Standard

A variety of optional commands can be used inside a geometrical object definitio
n block, after corners or vertex list / element connections are specified,
 to modify the basic composition of the object and its surface properties.
 These are described below.
 Geometrical transformations are described later, in section 
\begin_inset LatexCommand \ref{sec_geom_xform}

\end_inset 

.
\layout Standard


\begin_inset  Tabular
<lyxtabular version="3" rows="3" columns="2">
<features islongtable="true" headBottomDL="true">
<column alignment="left" valignment="top" leftline="true" width="0">
<column alignment="block" valignment="top" leftline="true" rightline="true" width="4in">
<row topline="true" bottomline="true" endhead="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\series bold 
Box Command
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard


\series bold 
Explanation
\end_inset 
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
CORNERS = [
\family sans 
\shape italic 
x1
\family typewriter 
\shape default 
,
\family sans 
\shape italic 
y1
\family typewriter 
\shape default 
,
\family sans 
\shape italic 
z1
\family typewriter 
\shape default 
],[
\family sans 
\shape italic 
x2
\family typewriter 
\shape default 
,
\family sans 
\shape italic 
y2
\family typewriter 
\shape default 
,
\family sans 
\shape italic 
z2
\family typewriter 
\shape default 
]
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

The box object has corners as specified.
 The first coordinates should be less than the second set of coordinates,
 although MCell3 may fix it if you do it incorrectly.
\end_inset 
</cell>
</row>
<row topline="true" bottomline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
ASPECT_RATIO = 
\family sans 
\shape italic 
a
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Make sure that the ratio of the long to short side of each triangle making
 up the box is no more than 
\family sans 
\shape italic 
a
\family default 
\shape default 
.
 The smallest allowed value is 2.
 The default is to not care about triangle shape.
\end_inset 
</cell>
</row>
</lyxtabular>

\end_inset 


\layout Standard


\begin_inset  Tabular
<lyxtabular version="3" rows="3" columns="2">
<features islongtable="true" headBottomDL="true">
<column alignment="left" valignment="top" leftline="true" width="0">
<column alignment="block" valignment="top" leftline="true" rightline="true" width="4in">
<row topline="true" bottomline="true" endhead="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\series bold 
Polygon Command
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard


\series bold 
Explanation
\end_inset 
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\begin_inset Minipage
position 0
inner_position 0
height "0pt"
width "30col%"
collapsed false

\layout Standard


\family typewriter 
VERTEX_LIST
\layout Standard


\family typewriter 
{
\layout Standard


\family typewriter 
\SpecialChar ~
\SpecialChar ~
[
\family sans 
\shape italic 
x0
\family typewriter 
\shape default 
,
\family sans 
\shape italic 
y0
\family typewriter 
\shape default 
,
\family sans 
\shape italic 
z0
\family typewriter 
\shape default 
]
\layout Standard


\family typewriter 
\SpecialChar ~
\SpecialChar ~
[
\family sans 
\shape italic 
x1
\family typewriter 
\shape default 
,
\family sans 
\shape italic 
y1
\family typewriter 
\shape default 
,
\family sans 
\shape italic 
z1
\family typewriter 
\shape default 
]
\layout Standard


\family typewriter 
\SpecialChar ~
\SpecialChar ~

\family sans 
\shape italic 
...
\layout Standard


\family typewriter 
}
\end_inset 


\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Specify the vertices of the triangles inside a polygon list object inside
 braces.
 Each vertex is given by its triple 
\family typewriter 
[
\family sans 
\shape italic 
x
\family typewriter 
\shape default 
,
\family sans 
\shape italic 
y
\family typewriter 
\shape default 
,
\family sans 
\shape italic 
z
\family typewriter 
\shape default 
]
\family default 
.
 This command must be given before the 
\family typewriter 
ELEMENT_CONNECTIONS
\family default 
 command.
\end_inset 
</cell>
</row>
<row topline="true" bottomline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\begin_inset Minipage
position 0
inner_position 0
height "0pt"
width "30col%"
collapsed false

\layout Standard


\family typewriter 
ELEMENT_CONNECTIONS
\layout Standard


\family typewriter 
{
\layout Standard


\family typewriter 
\SpecialChar ~
\SpecialChar ~
[
\family sans 
\shape italic 
a0
\family typewriter 
\shape default 
,
\family sans 
\shape italic 
b0
\family typewriter 
\shape default 
,
\family sans 
\shape italic 
c0
\family typewriter 
\shape default 
]
\layout Standard


\family typewriter 
\SpecialChar ~
\SpecialChar ~
[
\family sans 
\shape italic 
a1
\family typewriter 
\shape default 
,
\family sans 
\shape italic 
b1
\family typewriter 
\shape default 
,
\family sans 
\shape italic 
c1
\family typewriter 
\shape default 
]
\layout Standard


\family typewriter 
\SpecialChar ~
\SpecialChar ~

\family sans 
\shape italic 
...
\layout Standard


\family typewriter 
}
\end_inset 


\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Specify the triangles by vertex indices.
 The vertices are numbered from 
\family typewriter 
0
\family default 
 upwards in the order they were given in the vertex list.
 The direction of the surface normal is determined by the right-hand rule
 while following the vertices.
 Each triangle is given by a triple 
\family typewriter 
[
\family sans 
\shape italic 
a
\family typewriter 
\shape default 
,
\family sans 
\shape italic 
b
\family typewriter 
\shape default 
,
\family sans 
\shape italic 
c
\family typewriter 
\shape default 
]
\family default 
 of vertex numbers.
 This command must be given after the 
\family typewriter 
VERTEX_LIST
\family default 
 command.
\end_inset 
</cell>
</row>
</lyxtabular>

\end_inset 


\layout Standard


\begin_inset  Tabular
<lyxtabular version="3" rows="3" columns="2">
<features islongtable="true" headBottomDL="true">
<column alignment="left" valignment="top" leftline="true" width="0">
<column alignment="block" valignment="top" leftline="true" rightline="true" width="4in">
<row topline="true" bottomline="true" endhead="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\series bold 
Region Command
\end_inset 
</cell>
<cell multicolumn="1" alignment="block" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard


\series bold 
Explanation
\end_inset 
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\begin_inset Minipage
position 0
inner_position 0
height "0pt"
width "35col%"
collapsed false

\layout Standard


\family typewriter 
DEFINE_SURFACE_REGIONS
\layout Standard


\family typewriter 
{
\layout Standard


\family sans 
\shape italic 
\SpecialChar ~
\SpecialChar ~
nameA
\family typewriter 
\shape default 
 {
\layout Standard

\SpecialChar ~
\SpecialChar ~
\SpecialChar ~
\SpecialChar ~

\family sans 
\shape italic 
element specifier commands
\layout Standard

\SpecialChar ~
\SpecialChar ~
\SpecialChar ~
\SpecialChar ~

\family sans 
\shape italic 
regional surface commands
\layout Standard

\SpecialChar ~
\SpecialChar ~

\family typewriter 
}
\layout Standard


\family sans 
\shape italic 
\SpecialChar ~
\SpecialChar ~
name2
\family typewriter 
\shape default 
 { 
\family sans 
\shape italic 
...

\family typewriter 
\shape default 
 }
\layout Standard


\family sans 
\shape italic 
\SpecialChar ~
\SpecialChar ~
...
\layout Standard


\family typewriter 
}
\end_inset 


\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Define regions on the object.
 The extent of a region is given by the element specifier commands (at least
 one is required).
 Molecules can be added and surface properties can be set with the optional
 regional surface commands.
 You can have an arbitrary number of regions on an object, and they may
 overlap if you wish.
 Molecules added to overlapping regions accumulate; surface properties are
 those of the last region applied.
 
\end_inset 
</cell>
</row>
<row topline="true" bottomline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\begin_inset Minipage
position 0
inner_position 0
height "0pt"
width "35col%"
collapsed false

\layout Standard


\family typewriter 
REMOVE_ELEMENTS
\layout Standard


\family typewriter 
{
\layout Standard

\SpecialChar ~
\SpecialChar ~

\family sans 
\shape italic 
element specifier commands
\layout Standard


\family typewriter 
}
\end_inset 


\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Remove the portion of the object specified by the element specifiers.
 You can think of this as a special type of region that defines the removed
 portions of the object.
 No real region exists on any part of the object that has been removed.
 You can use a list of element numbers/names instead of element specifiers
 if you wish, but you cannot mix a list of element numbers/names with the
 element specifier syntax.
\end_inset 
</cell>
</row>
</lyxtabular>

\end_inset 


\layout Standard


\begin_inset  Tabular
<lyxtabular version="3" rows="7" columns="2">
<features islongtable="true" headBottomDL="true">
<column alignment="left" valignment="top" leftline="true" width="0">
<column alignment="block" valignment="top" leftline="true" rightline="true" width="4in">
<row topline="true" bottomline="true" endhead="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\series bold 
Element Specifier Command
\end_inset 
</cell>
<cell multicolumn="1" alignment="block" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard


\series bold 
Explanation
\end_inset 
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
INCLUDE_ELEMENTS = [ 
\family sans 
\shape italic 
list
\family typewriter 
\shape default 
 ]
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Include the elements specified by number or name.
 For polygon objects, these refer to the triangles defined by the element
 connections, counting from zero upwards in the order given.
 For boxes, the side names 
\family typewriter 
LEFT
\family default 
, 
\family typewriter 
RIGHT
\family default 
, 
\family typewriter 
FRONT
\family default 
, 
\family typewriter 
BACK
\family default 
, 
\family typewriter 
BOTTOM
\family default 
, and 
\family typewriter 
TOP
\family default 
 can be used to refer to the sides, where left/right corresponds to the
 x axis (left is lower x values), front/back to y, and bottom/top to z.
 
\family typewriter 
ALL_ELEMENTS
\family default 
 refers to the entire object.
 Numbers can be specified individually (separated by commas) or in ranges
 with the format 
\family sans 
\shape italic 
N
\family default 
\shape default 
 
\family typewriter 
TO
\family default 
 
\family sans 
\shape italic 
M
\family default 
\shape default 
.
 The two styles can be mixed (separated by commas).
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
EXCLUDE_ELEMENTS = [ 
\family sans 
\shape italic 
list
\family typewriter 
\shape default 
 ]
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Exclude the elements listed.
 If this is the first element specifier, assume that all elements not listed
 are included.
 If not, subtract from the existing list.
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
INCLUDE_REGION = 
\family sans 
\shape italic 
name
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Include the existing region on this object called 
\family sans 
\shape italic 
name
\family default 
\shape default 
 into this region, too.
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
EXCLUDE_REGION = 
\family sans 
\shape italic 
name
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Exclude the existing region on this object called 
\family sans 
\shape italic 
name
\family default 
\shape default 
 from this new region.
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
INCLUDE_PATCH=[
\family sans 
\shape italic 
x1
\family typewriter 
\shape default 
,
\family sans 
\shape italic 
y1
\family typewriter 
\shape default 
,
\family sans 
\shape italic 
z1
\family typewriter 
\shape default 
],[
\family sans 
\shape italic 
x2
\family typewriter 
\shape default 
,
\family sans 
\shape italic 
y2
\family typewriter 
\shape default 
,
\family sans 
\shape italic 
z2
\family typewriter 
\shape default 
]
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

This specifier is only valid on box objects, and the corners must define
 a rectangular patch that is on exactly one side of the box.
 The box will be divided into triangles in such a way that this patch consists
 of separate triangles and will form a region.
\end_inset 
</cell>
</row>
<row topline="true" bottomline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
EXCLUDE_PATCH=[
\family sans 
\shape italic 
x1
\family typewriter 
\shape default 
,
\family sans 
\shape italic 
y1
\family typewriter 
\shape default 
,
\family sans 
\shape italic 
z1
\family typewriter 
\shape default 
],[
\family sans 
\shape italic 
x2
\family typewriter 
\shape default 
,
\family sans 
\shape italic 
y2
\family typewriter 
\shape default 
,
\family sans 
\shape italic 
z2
\family typewriter 
\shape default 
]
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Exclude the patch from this region.
\end_inset 
</cell>
</row>
</lyxtabular>

\end_inset 


\layout Standard

After element specifiers, regions can specify a surface type and add extra
 molecules using
\layout Standard


\begin_inset  Tabular
<lyxtabular version="3" rows="4" columns="2">
<features islongtable="true" headBottomDL="true">
<column alignment="left" valignment="top" leftline="true" width="0">
<column alignment="block" valignment="top" leftline="true" rightline="true" width="4in">
<row topline="true" bottomline="true" endhead="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\series bold 
Regional Surface Command
\end_inset 
</cell>
<cell multicolumn="1" alignment="block" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard


\series bold 
Explanation
\end_inset 
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
SURFACE_CLASS = 
\family sans 
\shape italic 
name
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Set the surface type of this region to the previously defined surface class
 called 
\family sans 
\shape italic 
name
\family default 
\shape default 
.
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
MOLECULE_DENSITY {
\family sans 
\shape italic 
...
\family typewriter 
\shape default 
}
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

This is the same as the Surface Property Command of the same name.
\end_inset 
</cell>
</row>
<row topline="true" bottomline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
MOLECULE_NUMBER {
\family sans 
\shape italic 
...
\family typewriter 
\shape default 
}
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

This is the same as the Surface Property Command of the same name.
 Its usage is recommended here, as a regional surface command, rather than
 as a surface property command.
\end_inset 
</cell>
</row>
</lyxtabular>

\end_inset 


\layout Subsubsection

Release objects
\layout Standard

Release objects place molecules into the world.
 Release objects provide the only means of placing molecules in a three
 dimensional space, but some release shapes can place molecules on surfaces
 as well.
 Release objects are defined using the following commands:
\layout Standard


\begin_inset  Tabular
<lyxtabular version="3" rows="6" columns="2">
<features islongtable="true" headBottomDL="true">
<column alignment="left" valignment="top" leftline="true" width="0">
<column alignment="block" valignment="top" leftline="true" rightline="true" width="4in">
<row topline="true" bottomline="true" endhead="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\series bold 
Command
\end_inset 
</cell>
<cell multicolumn="1" alignment="block" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard


\series bold 
Explanation
\end_inset 
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\begin_inset Minipage
position 0
inner_position 0
height "0pt"
width "30col%"
collapsed false

\layout Standard


\family sans 
\shape italic 
name
\family typewriter 
\shape default 
 RELEASE_SITE
\layout Standard


\family typewriter 
{
\layout Standard

\SpecialChar ~
\SpecialChar ~

\family sans 
\shape italic 
release site commands
\layout Standard


\family sans 
\shape italic 
\SpecialChar ~
\SpecialChar ~
transformation commands
\layout Standard


\family typewriter 
}
\end_inset 


\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Create a release site called 
\family sans 
\shape italic 
name
\family default 
\shape default 
.
 The shape and method of release is specified by the release site commands.
 Optionally, geometrical transformations can be applied also.
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family sans 
\shape italic 
name
\family typewriter 
\shape default 
 CUBIC_RELEASE_SITE {
\family sans 
\shape italic 
...
\family typewriter 
\shape default 
}
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Create a cubic release site called 
\family sans 
\shape italic 
name
\family default 
\shape default 
.
 Molecules are released in a box as specified by the radius.
 (This is the same as using the 
\family typewriter 
SHAPE=CUBIC
\family default 
 command inside 
\family typewriter 
RELEASE_SITE
\family default 
.)
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family sans 
\shape italic 
name
\family typewriter 
\shape default 
 SPHERICAL_RELEASE_SITE {
\family sans 
\shape italic 
...
\family typewriter 
\shape default 
}
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Create a spherical release site called 
\family sans 
\shape italic 
name
\family default 
\shape default 
.
 Molecules are released uniformly within the sphere depending on the defined
 radius of the object.
 (This is the same as using the 
\family typewriter 
SHAPE=SPHERICAL
\family default 
 command inside 
\family typewriter 
RELEASE_SITE
\family default 
.)
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family sans 
\shape italic 
name
\family typewriter 
\shape default 
 SPHERICAL_SHELL_SITE {
\family sans 
\shape italic 
...
\family typewriter 
\shape default 
}
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Create a spherical shell release site called 
\family sans 
\shape italic 
name
\family default 
\shape default 
.
 Molecules are distributed on a spherical shell at the defined radius of
 the object.
 For now, you must specify the number to distribute, not a concentration.
 (This is the same as using the 
\family typewriter 
SHAPE=SPHERICAL_SHELL
\family default 
 command inside 
\family typewriter 
RELEASE_SITE
\family default 
.)
\end_inset 
</cell>
</row>
<row topline="true" bottomline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\begin_inset Minipage
position 0
inner_position 0
height "0pt"
width "35col%"
collapsed false

\layout Standard


\family typewriter 
DEFINE_RELEASE_PATTERN 
\family sans 
\shape italic 
name
\layout Standard


\family typewriter 
{
\layout Standard

\SpecialChar ~
\SpecialChar ~

\family sans 
\shape italic 
release pattern commands
\layout Standard


\family typewriter 
}
\end_inset 


\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Define a new release pattern according to the commands given.
 A release pattern must be defined for anything other than release at the
 beginning of the simulation.
 Release patterns must be defined before they are used.
 Multiple release sites can use the same pattern.
\end_inset 
</cell>
</row>
</lyxtabular>

\end_inset 


\layout Standard

The following commands define where, what, and when a release object releases
 molecules:
\layout Standard


\begin_inset  Tabular
<lyxtabular version="3" rows="12" columns="2">
<features islongtable="true" headBottomDL="true">
<column alignment="left" valignment="top" leftline="true" width="0">
<column alignment="block" valignment="top" leftline="true" rightline="true" width="4in">
<row topline="true" bottomline="true" endhead="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\series bold 
Release Site Command
\end_inset 
</cell>
<cell multicolumn="1" alignment="block" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard


\series bold 
Explanation
\end_inset 
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
SHAPE = 
\family sans 
\shape italic 
geometry
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Release molecules in the specified shape.
 Valid shapes are 
\family typewriter 
CUBIC
\family default 
, 
\family typewriter 
SPHERICAL
\family default 
, 
\family typewriter 
SPHERICAL_SHELL
\family default 
, and 
\family typewriter 
LIST
\family default 
; or the name of region(s) on which to release.
 Each region must already be instantiated or be inside the same 
\family typewriter 
OBJECT
\family default 
 as the release site (see 
\family typewriter 
OBJECT
\family default 
 command).
 Region names can be combined with 
\family typewriter 
+
\family default 
 to indicate release on both regions, 
\family typewriter 
-
\family default 
 to indicate the release occurs on the first and not the second, and 
\family typewriter 
*
\family default 
 to indicate the release occurs only where the two regions overlap.
 Parentheses may be used for grouping.
 If the molecule has a 3D diffusion constant, it will be released in the
 volume bounded by the regions and each region must be closed; otherwise,
 it will be released on the surface.
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
LOCATION = [
\family sans 
\shape italic 
x
\family typewriter 
\shape default 
,
\family sans 
\shape italic 
y
\family typewriter 
\shape default 
,
\family sans 
\shape italic 
z
\family typewriter 
\shape default 
]
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

The release occurs centered at this location.
 Only used for geometrical shapes.
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
MOLECULE = 
\family sans 
\shape italic 
name
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

The named molecule is the one that will be released.
 Not used for the 
\family typewriter 
LIST
\family default 
 shape.
 You must specify an orientation if the molecule is a surface molecule.
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\begin_inset Minipage
position 0
inner_position 0
height "0pt"
width "30col%"
collapsed false

\layout Standard


\family typewriter 
MOLECULE_POSITIONS
\layout Standard


\family typewriter 
{
\layout Standard

\SpecialChar ~
\SpecialChar ~

\family sans 
\shape italic 
name1
\family typewriter 
\shape default 
 [
\family sans 
\shape italic 
x1
\family typewriter 
\shape default 
,
\family sans 
\shape italic 
y1
\family typewriter 
\shape default 
,
\family sans 
\shape italic 
z1
\family typewriter 
\shape default 
]
\layout Standard

\SpecialChar ~
\SpecialChar ~

\family sans 
\shape italic 
name2
\family typewriter 
\shape default 
 [
\family sans 
\shape italic 
x2
\family typewriter 
\shape default 
,
\family sans 
\shape italic 
y2
\family typewriter 
\shape default 
,
\family sans 
\shape italic 
z2
\family typewriter 
\shape default 
]
\layout Standard

\SpecialChar ~
\SpecialChar ~

\family sans 
\shape italic 
...
\layout Standard


\family typewriter 
}
\end_inset 


\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

The named molecules are added in the locations given.
 The molecule names must be followed by orientation marks if they have a
 2D diffusion constant.
 If a molecule has a 2D diffusion constant, it will be placed on the surface
 closest to the coordinate given.
 This command is used for the 
\family typewriter 
LIST
\family default 
 shape only.
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
SITE_DIAMETER = 
\family sans 
\shape italic 
d
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

For a geometrical release site, this releases molecules uniformly within
 a diameter 
\family sans 
\shape italic 
d
\family default 
\shape default 
.
 Not used for releases on regions.
 With the 
\family typewriter 
LIST
\family default 
 shape, this is the distance that surface molecules search for a surface
 before giving up; free molecules pay no attention to this value for the
 
\family typewriter 
LIST
\family default 
 shape.
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
SITE_DIAMETER = [
\family sans 
\shape italic 
x
\family typewriter 
\shape default 
,
\family sans 
\shape italic 
y
\family typewriter 
\shape default 
,
\family sans 
\shape italic 
z
\family typewriter 
\shape default 
]
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Release is asymmetric with a different diameters in different directions,
 as indicated by the vector.
 Not used for releases on regions or with the 
\family typewriter 
LIST
\family default 
 shape.
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
RELEASE_PROBABILITY = 
\family sans 
\shape italic 
p
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

This release does not occur every time, but rather with probability 
\family sans 
\shape italic 
p
\family default 
\shape default 
.
 (If omitted, the default is to release without fail.) Either the whole release
 occurs or none of it does; the probability does not apply molecule-by-molecule.
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
NUMBER_TO_RELEASE = 
\family sans 
\shape italic 
n
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Release 
\family sans 
\shape italic 
n
\family default 
\shape default 
 molecules.
 For releases on regions, 
\family sans 
\shape italic 
n
\family default 
\shape default 
 can be negative, and the release will then remove molecules of that type
 from the region.
 To remove all molecules of a type, just make 
\family sans 
\shape italic 
n
\family default 
\shape default 
 large and negative.
 It is unwise to both add and remove molecules on the same timestep---the
 order of addition and removal is not defined in that case.
 This directive is not used for the 
\family typewriter 
LIST
\family default 
 shape, as every molecule is specified.
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
CONCENTRATION = 
\family sans 
\shape italic 
c
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Release molecules at concentration 
\family sans 
\shape italic 
c
\family default 
\shape default 
 molar for volumes and 
\family sans 
\shape italic 
c
\family default 
\shape default 
 molecules per square micron for surfaces.
 Not used for the 
\family typewriter 
LIST
\family default 
 shape.
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\begin_inset Minipage
position 0
inner_position 0
height "0pt"
width "30col%"
collapsed false

\layout Standard


\family typewriter 
GAUSSIAN_RELEASE_NUMBER
\layout Standard


\family typewriter 
{
\layout Standard

\SpecialChar ~
\SpecialChar ~

\family typewriter 
MEAN_NUMBER = 
\family sans 
\shape italic 
n
\layout Standard

\SpecialChar ~
\SpecialChar ~

\family typewriter 
STANDARD_DEVIATION = 
\family sans 
\shape italic 
s
\layout Standard


\family typewriter 
}
\end_inset 


\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Release molecules according to a Gaussian distribution with the specified
 mean and standard deviation.
\end_inset 
</cell>
</row>
<row topline="true" bottomline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
RELEASE_PATTERN = 
\family sans 
\shape italic 
name
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Use the named release pattern instead of the default.
 The default is to release the specified number of molecules at the beginning
 of the simulation.
\end_inset 
</cell>
</row>
</lyxtabular>

\end_inset 


\layout Standard

Release patterns are defined as follows.
\layout Standard


\begin_inset  Tabular
<lyxtabular version="3" rows="7" columns="2">
<features islongtable="true" headBottomDL="true">
<column alignment="left" valignment="top" leftline="true" width="0">
<column alignment="block" valignment="top" leftline="true" rightline="true" width="4in">
<row topline="true" bottomline="true" endhead="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\series bold 
Release Pattern Command
\end_inset 
</cell>
<cell multicolumn="1" alignment="block" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard


\series bold 
Explanation
\end_inset 
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
DELAY = 
\family sans 
\shape italic 
t
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

The release pattern will start at time 
\family sans 
\shape italic 
t
\family default 
\shape default 
.
 (Default is to start at time zero.)
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
RELEASE_INTERVAL = 
\family sans 
\shape italic 
t
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

During a train of releases, release molecules after every 
\family sans 
\shape italic 
t
\family default 
\shape default 
 seconds.
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
TRAIN_DURATION = 
\family sans 
\shape italic 
t
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

The train of releases lasts for 
\family sans 
\shape italic 
t
\family default 
\shape default 
 seconds.
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
TRAIN_INTERVAL = 
\family sans 
\shape italic 
t
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

A new train of releases happens every 
\family sans 
\shape italic 
t
\family default 
\shape default 
 seconds.
 Behavior is undefined if the interval is less than the duration.
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
NUMBER_OF_TRAINS = 
\family sans 
\shape italic 
n
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Repeat the release process for 
\family sans 
\shape italic 
n
\family default 
\shape default 
 trains of releases.
\end_inset 
</cell>
</row>
<row topline="true" bottomline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
NUMBER_OF_TRAINS = UNLIMITED
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Repeat trains forever.
\end_inset 
</cell>
</row>
</lyxtabular>

\end_inset 


\layout Subsubsection

Instantiation of objects
\layout Standard

An object is a box, polygon, release site, or a metaobject which contains
 other objects.
 Metaobjects are defined using
\layout Standard


\begin_inset  Tabular
<lyxtabular version="3" rows="3" columns="2">
<features islongtable="true" headBottomDL="true">
<column alignment="left" valignment="top" leftline="true" width="0">
<column alignment="block" valignment="top" leftline="true" rightline="true" width="4in">
<row topline="true" bottomline="true" endhead="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\series bold 
Command
\end_inset 
</cell>
<cell multicolumn="1" alignment="block" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard


\series bold 
Explanation
\end_inset 
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\begin_inset Minipage
position 0
inner_position 0
height "0pt"
width "30col%"
collapsed false

\layout Standard


\family sans 
\shape italic 
name
\family typewriter 
\shape default 
 OBJECT
\layout Standard


\family typewriter 
{
\layout Standard

\SpecialChar ~
\SpecialChar ~

\family sans 
\shape italic 
object specifier commands
\layout Standard

\SpecialChar ~
\SpecialChar ~

\family sans 
\shape italic 
transformation commands
\layout Standard


\family typewriter 
}
\end_inset 


\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Define a new object called 
\family sans 
\shape italic 
name
\family default 
\shape default 
.
 Inside the braces, list other objects one at a time to be added (see below).
\end_inset 
</cell>
</row>
<row topline="true" bottomline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
INSTANTIATE 
\family sans 
\shape italic 
name
\family typewriter 
\shape default 
 OBJECT { 
\family sans 
\shape italic 
...

\family typewriter 
\shape default 
 }
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Same as above, except we also insert the object into the world.
 A simulation must have at least one 
\family typewriter 
INSTANTIATE
\family default 
d object.
\end_inset 
</cell>
</row>
</lyxtabular>

\end_inset 


\layout Standard

You can define release sites, boxes, and polygon objects inside another
 object, as well as placing previously defined objects into existing ones:
\layout Standard


\begin_inset  Tabular
<lyxtabular version="3" rows="6" columns="2">
<features islongtable="true" headBottomDL="true">
<column alignment="left" valignment="top" leftline="true" width="0">
<column alignment="block" valignment="top" leftline="true" rightline="true" width="4in">
<row topline="true" bottomline="true" endhead="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\series bold 
Object Specifer Command
\end_inset 
</cell>
<cell multicolumn="1" alignment="block" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard


\series bold 
Explanation
\end_inset 
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\begin_inset Minipage
position 0
inner_position 0
height "0pt"
width "30col%"
collapsed false

\layout Standard


\family sans 
\shape italic 
newname
\family typewriter 
\shape default 
 OBJECT 
\family sans 
\shape italic 
oldname
\family typewriter 
\shape default 
 
\layout Standard


\family typewriter 
{
\layout Standard

\SpecialChar ~
\SpecialChar ~

\family sans 
\shape italic 
transformation commands
\layout Standard


\family typewriter 
}
\end_inset 


\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Add the existing object called 
\family sans 
\shape italic 
oldname
\family default 
\shape default 
 into the existing object and label it 
\family sans 
\shape italic 
newname
\family default 
\shape default 
.
 You can add extra commands (e.g.
 transformation) inside the braces.
 The old and new names can be the same thing.
 Thereafter, this object can be referred to in the world as 
\family sans 
\shape italic 
name
\family typewriter 
\shape default 
.
\family sans 
\shape italic 
newname
\family default 
\shape default 
.
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family sans 
\shape italic 
name
\family typewriter 
\shape default 
 BOX {
\family sans 
\shape italic 
...
\family typewriter 
\shape default 
}
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Create a box inside the existing object (using the same syntax as previously
 defined).
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family sans 
\shape italic 
name
\family typewriter 
\shape default 
 POLYGON_LIST {
\family sans 
\shape italic 
...
\family typewriter 
\shape default 
}
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Create a polygon list object inside the existing object (using the same
 syntax as previously defined).
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family sans 
\shape italic 
name
\family typewriter 
\shape default 
 RELEASE_SITE {
\family sans 
\shape italic 
...
\family typewriter 
\shape default 
}
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Create a release site inside the existing object.
\end_inset 
</cell>
</row>
<row topline="true" bottomline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family sans 
\shape italic 
newname
\family typewriter 
\shape default 
 OBJECT {
\family sans 
\shape italic 
...
\family typewriter 
\shape default 
}
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Create an object inside the existing object.
\end_inset 
</cell>
</row>
</lyxtabular>

\end_inset 


\layout Subsubsection

Geometrical transformations
\begin_inset LatexCommand \label{sec_geom_xform}

\end_inset 


\layout Standard

At the end of the definition of a release object or geometrical object,
 or in the block where an object is instantiated, it can be moved using
 the following transformation commands (placed at the end of the block before
 the closing brace).
\layout Standard


\begin_inset  Tabular
<lyxtabular version="3" rows="4" columns="2">
<features islongtable="true" headBottomDL="true">
<column alignment="left" valignment="top" leftline="true" width="0">
<column alignment="block" valignment="top" leftline="true" rightline="true" width="4in">
<row topline="true" bottomline="true" endhead="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\series bold 
Transformation Command
\end_inset 
</cell>
<cell multicolumn="1" alignment="block" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard


\series bold 
Explanation
\end_inset 
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
TRANSLATE = [
\family sans 
\shape italic 
x
\family typewriter 
\shape default 
,
\family sans 
\shape italic 
y
\family typewriter 
\shape default 
,
\family sans 
\shape italic 
z
\family typewriter 
\shape default 
]
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Move the object by the specified vector.
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
SCALE = [
\family sans 
\shape italic 
x
\family typewriter 
\shape default 
,
\family sans 
\shape italic 
y
\family typewriter 
\shape default 
,
\family sans 
\shape italic 
z
\family typewriter 
\shape default 
]
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Scale the object by multiplying each coordinate by the corresponding value
 in the vector.
\end_inset 
</cell>
</row>
<row topline="true" bottomline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
ROTATE = [
\family sans 
\shape italic 
x
\family typewriter 
\shape default 
,
\family sans 
\shape italic 
y
\family typewriter 
\shape default 
,
\family sans 
\shape italic 
z
\family typewriter 
\shape default 
] , 
\family sans 
\shape italic 
A
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Rotate 
\family sans 
\shape italic 
A
\family default 
\shape default 
 degrees about the axis defined by the supplied vector.
\end_inset 
</cell>
</row>
</lyxtabular>

\end_inset 


\layout Subsection

Output specification commands
\layout Standard

There are two forms of output in MCell3, visualization output and count
 output.
 Visualization output typically contains the molecules and/or geometry of
 the model in a form suitable for visualization or analysis that requires
 knowledge of the precise location of particles.
 Count output reports running totals of summary statistics such as the total
 number of molecules of a certain type in the world, the number of times
 a reaction has occurred inside some object in the world, and so on.
\layout Standard


\begin_inset  Tabular
<lyxtabular version="3" rows="3" columns="2">
<features islongtable="true" headBottomDL="true">
<column alignment="left" valignment="top" leftline="true" width="0">
<column alignment="block" valignment="top" leftline="true" rightline="true" width="4in">
<row topline="true" bottomline="true" endhead="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\series bold 
Command
\end_inset 
</cell>
<cell multicolumn="1" alignment="block" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard


\series bold 
Explanation
\end_inset 
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
VIZ_DATA_OUTPUT { 
\family sans 
\shape italic 
...

\family typewriter 
\shape default 
 }
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Define a new visualization data output block which contains the commands
 that are not yet described in this document.
 Each mdl file can have multiple visualization blocks, but they must all
 have the same mode.
\end_inset 
</cell>
</row>
<row topline="true" bottomline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\begin_inset Minipage
position 0
inner_position 0
height "0pt"
width "35col%"
collapsed false

\layout Standard


\family typewriter 
REACTION_DATA_OUTPUT
\layout Standard


\family typewriter 
{
\layout Standard

\SpecialChar ~
\SpecialChar ~

\family sans 
\shape italic 
reaction output commands
\layout Standard


\family typewriter 
}
\end_inset 


\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Define a new count data output block which contains the commands below.
 Each mdl file can have multiple reaction data output blocks.
\end_inset 
</cell>
</row>
</lyxtabular>

\end_inset 


\layout Standard

Each reaction data output block consists of the following commands:
\layout Standard


\begin_inset  Tabular
<lyxtabular version="3" rows="7" columns="2">
<features islongtable="true" headBottomDL="true">
<column alignment="left" valignment="top" leftline="true" width="0">
<column alignment="block" valignment="top" leftline="true" rightline="true" width="4in">
<row topline="true" bottomline="true" endhead="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\series bold 
Reaction Output Command
\end_inset 
</cell>
<cell multicolumn="1" alignment="block" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard


\series bold 
Explanation
\end_inset 
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
OUTPUT_BUFFER_SIZE = 
\family sans 
\shape italic 
N
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Write output to disk after every 
\family sans 
\shape italic 
N
\family default 
\shape default 
 blocks.
 The default is 
\family sans 
\shape italic 
N
\family default 
\shape default 
=10000.
 This command is optional, but must be first if it is used.
 The output will also always be written when the simulation terminates,
 regardless of 
\family sans 
\shape italic 
N
\family default 
\shape default 
.
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
STEP = 
\family sans 
\shape italic 
t
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Output this block every 
\family sans 
\shape italic 
t
\family default 
\shape default 
 seconds.
 Exactly one of STEP or the following two commands should be used.
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
TIME_LIST = [ 
\family sans 
\shape italic 
list
\family typewriter 
\shape default 
 ]
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Output this block at the times specified in the list.
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
ITERATION_LIST = [ 
\family sans 
\shape italic 
list
\family typewriter 
\shape default 
 ]
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Output this block at the iteration numbers specified in the list (i.e.
 after that number of timesteps).
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
{ 
\family sans 
\shape italic 
value
\family typewriter 
\shape default 
 } => 
\begin_inset Quotes eld
\end_inset 


\family sans 
\shape italic 
file
\family typewriter 
\shape default 

\begin_inset Quotes erd
\end_inset 


\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Output the value in braces to the filename in quotes.
 The first column will be the timestep; the second will be the value listed.
 This command can be repeated to send different output to many files.
\end_inset 
</cell>
</row>
<row topline="true" bottomline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
{ 
\family sans 
\shape italic 
value
\family typewriter 
\shape default 
 , 
\family sans 
\shape italic 
value
\family typewriter 
\shape default 
 , 
\family sans 
\shape italic 
...

\family typewriter 
\shape default 
 } => 
\begin_inset Quotes eld
\end_inset 


\family sans 
\shape italic 
file
\family typewriter 
\shape default 

\begin_inset Quotes erd
\end_inset 


\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Output the list of values in braces, one to a column, in the order listed.
 The first column will be the timestep.
 This command can be repeated.
\end_inset 
</cell>
</row>
</lyxtabular>

\end_inset 


\layout Standard

The values specified in braces are count statements, or mathematical operations
 applied to count statements (e.g.
 you can add, subtract, etc.
 count statements to each other and to constants and so on).
 The count statements themselves have the following syntax:
\layout Standard


\begin_inset  Tabular
<lyxtabular version="3" rows="7" columns="2">
<features islongtable="true" headBottomDL="true">
<column alignment="left" valignment="top" leftline="true" width="0">
<column alignment="block" valignment="top" leftline="true" rightline="true" width="4in">
<row topline="true" bottomline="true" endhead="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\series bold 
Count Statement
\end_inset 
</cell>
<cell multicolumn="1" alignment="block" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard


\series bold 
Explanation
\end_inset 
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
COUNT[
\family sans 
\shape italic 
name
\family typewriter 
\shape default 
 , WORLD]
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Count things in the world.
 If 
\family sans 
\shape italic 
name
\family default 
\shape default 
 refers to a molecule, count how many of that molecule are in the world.
 If it refers to a reaction, count how many times that reaction has occurred
 so far.
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
COUNT[
\family sans 
\shape italic 
name
\family typewriter 
\shape default 
 , 
\family sans 
\shape italic 
object
\family typewriter 
\shape default 
]
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Count things inside the object called 
\family sans 
\shape italic 
object
\family default 
\shape default 
.
 This must be an instantiated object.
 For example, if you have instantiated an object called 
\family typewriter 
my_world
\family default 
 with a box called 
\family typewriter 
my_box
\family default 
 inside it, 
\family sans 
\shape italic 
object
\family default 
\shape default 
 would be 
\family typewriter 
my_world.my_box
\family default 
.
 If you are counting surface molecules or reactions at a surface, only the
 ones that actually occur on 
\family sans 
\shape italic 
object
\family default 
\shape default 
 will be counted.
 Molecules with a 3D diffusion constant will be counted inside the object,
 but the object must be closed.
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
COUNT[
\family sans 
\shape italic 
name
\family typewriter 
\shape default 
 , 
\family sans 
\shape italic 
region
\family typewriter 
\shape default 
]
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Count things inside the named region.
 It must be referenced fully.
 E.g.
 if 
\family typewriter 
my_box
\family default 
 (from above) has a region called 
\family typewriter 
my_region
\family default 
, the name would be 
\family typewriter 
my_world.my_box[my_region]
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
COUNT[
\family sans 
\shape italic 
name
\family typewriter 
\shape default 
,
\family sans 
\shape italic 
region
\family typewriter 
\shape default 
,ALL_ENCLOSED]
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Count all reactions that occur inside this region (not counting those that
 occur on the surface of the region).
 This lets you count surface molecules contained within a box, for example.
 This will work with objects as well as regions, but the object or region
 must be closed.
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
COUNT[
\family sans 
\shape italic 
name
\family typewriter 
\shape default 
,
\family sans 
\shape italic 
region
\family typewriter 
\shape default 
,CONCENTRATION]
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Estimate the concentration of the molecule at that region, averaged since
 the beginning of the simulation (output has units of 
\begin_inset Formula $\mu\mathrm{{M}}$
\end_inset 

).
 A single object can be used instead of a region, but multiple objects cannot
 be used.
 The region/object does not need to be closed.
 To find the average concentration during one count interval, let 
\begin_inset Formula $t_{i}$
\end_inset 

 be the time of the 
\begin_inset Formula $i$
\end_inset 

th output, let 
\begin_inset Formula $t_{j}$
\end_inset 

 be some earlier output, and let 
\begin_inset Formula $\bar{c}\left(t\right)$
\end_inset 

 be the concentration averaged up to time 
\begin_inset Formula $t$
\end_inset 

.
 Then the average concentration between times 
\begin_inset Formula $t_{j}$
\end_inset 

 and 
\begin_inset Formula $t_{i}$
\end_inset 

 is 
\begin_inset Formula $\bar{c}\left(t_{j}\rightarrow t_{i}\right)=\frac{t_{i}\bar{c}\left(t_{i}\right)-t_{j}\bar{c}\left(t_{j}\right)}{t_{i}-t_{j}}$
\end_inset 

.
 Note that this is the concentration all around the surface, so if the molecule
 can only reach one side, the concentration on that side will be twice what
 is reported here.
\end_inset 
</cell>
</row>
<row topline="true" bottomline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
COUNT[
\family sans 
\shape italic 
name
\family typewriter 
\shape default 
,
\family sans 
\shape italic 
region
\family typewriter 
\shape default 
,
\family sans 
\shape italic 
hits
\family typewriter 
\shape default 
]
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Output the number of times the named molecule has hit the named region (or
 object).
 The 
\family sans 
\shape italic 
hits
\family default 
\shape default 
 specifier should be one of 
\family typewriter 
FRONT_HITS
\family default 
, 
\family typewriter 
BACK_HITS
\family default 
, 
\family typewriter 
ALL_HITS
\family default 
, 
\family typewriter 
FRONT_CROSSINGS
\family default 
, 
\family typewriter 
BACK_CROSSINGS
\family default 
, and 
\family typewriter 
ALL_CROSSINGS
\family default 
.
\end_inset 
</cell>
</row>
</lyxtabular>

\end_inset 


\layout Subsection

Utility commands
\layout Standard

MCell3 understands the standard numeric operations 
\family typewriter 
+ - * /
\family default 
 as well as the following standard numerical functions:
\layout Standard


\begin_inset  Tabular
<lyxtabular version="3" rows="20" columns="2">
<features islongtable="true" headBottomDL="true">
<column alignment="left" valignment="top" leftline="true" width="0">
<column alignment="block" valignment="top" leftline="true" rightline="true" width="4in">
<row topline="true" bottomline="true" endhead="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\series bold 
Numerical Command
\end_inset 
</cell>
<cell multicolumn="1" alignment="block" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard


\series bold 
Explanation
\end_inset 
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
SQRT(
\family sans 
\shape italic 
x
\family typewriter 
\shape default 
)
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Return the square root of 
\family sans 
\shape italic 
x
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
EXP(
\family sans 
\shape italic 
x
\family typewriter 
\shape default 
)
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Return the value of 
\begin_inset Formula $e$
\end_inset 

 raised to the 
\family sans 
\shape italic 
x
\begin_inset Formula $^{\textrm{th}}$
\end_inset 

 
\family default 
\shape default 
power
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
LOG(
\family sans 
\shape italic 
x
\family typewriter 
\shape default 
)
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Return the natural logarithm of 
\family sans 
\shape italic 
x
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
LOG10(
\family sans 
\shape italic 
x
\family typewriter 
\shape default 
)
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Return the base 10 logarithm of 
\family sans 
\shape italic 
x
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
SIN(
\family sans 
\shape italic 
x
\family typewriter 
\shape default 
)
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Return the sine of 
\family sans 
\shape italic 
x
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
COS(
\family sans 
\shape italic 
x
\family typewriter 
\shape default 
)
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Return the cosine of 
\family sans 
\shape italic 
x
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
TAN(
\family sans 
\shape italic 
x
\family typewriter 
\shape default 
)
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Return the tangent of 
\family sans 
\shape italic 
x
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
ASIN(
\family sans 
\shape italic 
x
\family typewriter 
\shape default 
)
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Return the inverse sine of 
\family sans 
\shape italic 
x
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
ACOS(
\family sans 
\shape italic 
x
\family typewriter 
\shape default 
)
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Return the inverse cosine of 
\family sans 
\shape italic 
x
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
ATAN(
\family sans 
\shape italic 
x
\family typewriter 
\shape default 
)
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Return the inverse tangent of 
\family sans 
\shape italic 
x
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
ABS(
\family sans 
\shape italic 
x
\family typewriter 
\shape default 
)
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Return the absolute value of 
\family sans 
\shape italic 
x
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
CEIL(
\family sans 
\shape italic 
x
\family typewriter 
\shape default 
)
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Return the smallest integer at least as big as 
\family sans 
\shape italic 
x
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
FLOOR(
\family sans 
\shape italic 
x
\family typewriter 
\shape default 
)
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Return the largest integer at no bigger than 
\family sans 
\shape italic 
x
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
MAX(
\family sans 
\shape italic 
x
\family typewriter 
\shape default 
,
\family sans 
\shape italic 
y
\family typewriter 
\shape default 
)
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Return the larger of 
\family sans 
\shape italic 
x
\family default 
\shape default 
 and 
\family sans 
\shape italic 
y
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
MIN(
\family sans 
\shape italic 
x
\family typewriter 
\shape default 
,
\family sans 
\shape italic 
y
\family typewriter 
\shape default 
)
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Return the smaller of 
\family sans 
\shape italic 
x
\family default 
\shape default 
 and 
\family sans 
\shape italic 
y
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
RAND_UNIFORM
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Return a random number uniformly distributed between 0 and 1
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
RAND_GAUSSIAN
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

Return a random number from a Gaussian distribution with mean 0 and standard
 deviation 1.
\end_inset 
</cell>
</row>
<row topline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
PI
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

The numeric value 
\begin_inset Formula $\pi=3.14159265358979323846$
\end_inset 


\end_inset 
</cell>
</row>
<row topline="true" bottomline="true">
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\layout Standard


\family typewriter 
SEED
\end_inset 
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\layout Standard

The value of the random number generator seed
\end_inset 
</cell>
</row>
</lyxtabular>

\end_inset 


\layout Standard

At any outer block in MCell3, one can define variables simply by assigning
 a value to the name of the variable.
 E.g.
 
\family typewriter 
my_lucky_number=13
\family default 
 would be a valid (if unusual) way to define a variable.
 Variables can take numeric, array, or string values.
 String values consist of text between double quotes.
 Array values are lists of numbers inside brackets separated by commas,
 or starting and ending values plus a step size, as exemplified below (note
 the double brackets):
\layout LyX-Code

my_lucky_number = 13
\layout LyX-Code

my_favorite_array = [1,3,5,7,11,17]
\layout LyX-Code

my_second_favorite_array = [[1.3 TO 2.75 STEP 0.331]]
\layout LyX-Code

my_boring_string = 
\begin_inset Quotes eld
\end_inset 

la la la, la la la
\begin_inset Quotes erd
\end_inset 


\layout Standard

The C-style 
\family typewriter 
printf
\family default 
 and 
\family typewriter 
sprintf
\family default 
 commands work too, pretty much the way you'd expect them to.
 MCell3 comments are delimited by 
\family typewriter 
/*
\family default 
 and 
\family typewriter 
*/
\family default 
.
\layout Standard


\emph on 
!!
\emph default 
Include file syntax should be described here, but it is not
\emph on 
!!
\layout Section

Technical details affecting simulation speed and accuracy
\layout Subsection

Partitioning
\layout Standard

In future releases, MCell3 will automatically partition space to improve
 execution speed.
 Currently, however, this must be performed manually.
 In general, partitions should be chosen to avoid having too many surfaces
 and molecules in one subvolume defined by the partitions.
 Molecules that are specified as 
\family typewriter 
TARGET_ONLY
\family default 
 or which do not interact with other molecules diffusing in 3D need only
 have relatively few surfaces in one subvolume.
\layout Standard

If there are few surfaces and/or molecules in a subvolume, it is advantageous
 to have the subvolume as large as possible.
 Crossing partition boundaries takes a small amount of time, so it is rarely
 useful to have partitions more finely spaced than the average diffusion
 distance of the faster-moving molecules in the simulation.
\layout Standard

In cases where the diffusing molecules do not interact with each other,
 they can safely take extended time-steps by measuring how far they are
 from things they could interact with.
 In this case, the partitions with no surfaces should be as large as possible.
 For example, a box works well with partitions just inside its outer walls.
\layout Standard

Finally, note that partition placement is not exact.
 The model is divided into 16384 possible partition boundaries, so partitions
 may shift by up to about one part in twenty thousand of the size of the
 model.
 For instance, if the model has a structure that is 6
\begin_inset Formula $\mu$
\end_inset 

m long, partitions may vary by about 0.0003
\begin_inset Formula $\mu$
\end_inset 

m.
 Thus, do not place partitions too close to objects in your model or they
 may not appear on the side you expect them to appear.
\layout Subsection

Mean diffusion distance
\layout Standard

Diffusion in MCell3 (and in earlier versions of MCell) is modeled as a series
 of motions in a straight line.
 This is a good approximation around geometry that is of a larger scale
 than the mean diffusion length for the timestep of the molecule in question.
 For accurate results around intricate geometry, it may be necessary to
 reduce the time step (or space step).
\layout Subsection

Reaction probabilities
\layout Standard

MCell3 assigns a probability of reaction for each collision.
 These probabilities are chosen to match the bulk reaction rate specified
 in the mdl file.
 The match will not occur, however, if the probability goes above 1.0.
 Internal correction factors can also raise the actual probability above
 the typical probability specified at the beginning.
 Therefore, MCell3 will output a warning if the reaction probability goes
 above 0.8 for reactions where a 3D diffusing molecule hits a surface, or
 if the probability goes above 0.3 for a collision between pairs of 3D diffusing
 molecules.
\layout Standard

If warnings are given (and possibly even if they are not), one should reduce
 the time step to lower the probabilities and see if the same results are
 generated.
 If not, simulations should be run with shorter time steps in order to avoid
 overly high probabilities.
\layout Standard

Unimolecular reactions with half-lives of less than one time step are also
 not perfectly accurate.
 Although unimolecular transitions will always occur at the right rate,
 other molecules may not experience the right effective concentration of
 each state, since a short-lifetime species may not be converted to another
 species until the end of the time step after which many other molecules
 may have had a chance to interact with it.
 Thus, the shortest-lifetime species in a series of unimolecular transitions
 should not have a half-life of less than approximately one time step if
 other molecules can interact with that state.
\layout Standard


\emph on 
!!
\emph default 
Need to describe the messages that MCell3 spits out when it detects an error
 with probabilities (at the end of a run)
\emph on 
!!
\layout Subsection

Interaction radii
\layout Standard

Bimolecular reactions occur within a distance specified by the 
\family typewriter 
INTERACTION_RADIUS
\family default 
 command.
 In many cases, one may want to increase or decrease this value.
 In particular, in order to get the right probability of reaction, MCell3
 increases the probability of reaction when near surfaces and partition
 boundaries.
 In general, the reaction rate has approximately 1-2% error if the average
 spacing between surfaces is at least 10 times the interaction radius, and
 the reaction probabilities are 0.3 or less.
\layout Standard

For example, if one has partitions spaced 0.02
\begin_inset Formula $\mu$
\end_inset 

m apart, simulation accuracy will be poor with the default interaction radius
 of 0.01
\begin_inset Formula $\mu$
\end_inset 

m.
 Thus, one might wish to specify 
\family typewriter 
INTERACTION_RADIUS=0.001
\family default 
.
\layout Subsection

Placing molecules in the world
\layout Standard

There are two ways to place molecules on surfaces: with a release site on
 a region, and as part of the property of a surface or region.
 Release sites are more flexible but slower; if you do not need the flexibility
 of release site notation, you're better off defining a region and using
 the 
\family typewriter 
MOLECULE_DENSITY
\family default 
 or 
\family typewriter 
MOLECULE_NUMBER
\family default 
 commands to add molecules at initialization.
\layout Standard

All placement of molecules in volumes is done with release sites.
 However, the geometrical release sites (
\family typewriter 
CUBIC
\family default 
 and 
\family typewriter 
SPHERICAL
\family default 
) require less computation to place each molecule.
 Thus, these should be used preferentially for simple geometry.
 To release many particles at a one point, use a cubic release site and
 set the diameter to 0.
 To release many particles at different points, use the 
\family typewriter 
LIST
\family default 
 release type.
\layout Section

Example models
\layout Subsection

Ligand-gated ion channel
\layout Standard

Below are a set of molecule definitions and reactions that specify an ion
 channel that is gated by the binding of a single ligand.
\layout LyX-Code

DEFINE_MOLECULES {
\layout LyX-Code

  channel_unbound { D_2D=0 }
\layout LyX-Code

  channel_bound   { D_2D=0 }
\layout LyX-Code

  channel_open    { D_2D=0 }
\layout LyX-Code

  ligand          { D_3D=2e-8 }
\layout LyX-Code

  ion             { D_3D=3e-8 }
\layout LyX-Code

}
\layout LyX-Code

DEFINE_REACTIONS {
\layout LyX-Code

  channel_unbound' + ligand' -> channel_bound'             [1e7]
\layout LyX-Code

  channel_bound'             -> channel_unbound' + ligand' [2e2]
\layout LyX-Code

  channel_bound'             -> channel_open'              [5e2]
\layout LyX-Code

  channel_open'              -> channel_open'    + ion,    [8e4]
\layout LyX-Code

}
\layout Standard

We have defined a reaction where a ligand binds to one end of a channel
 (presumably the extracellular face), which causes the channel to be in
 its bound state.
 In that state it can either release the ligand or become open.
 While open, it will emit ions on the other end (presumably the intracellular
 face).
 This would be suitable if the ion concentration is much higher outside
 than inside, or the membrane potential makes it highly favorable for the
 ion to move inside, so that we don't have to worry about the reverse reaction.
 If there is no electrical driving force, we might have to model ions both
 inside and outside:
\layout LyX-Code

DEFINE_REACTIONS {
\layout LyX-Code

  channel_unbound' + ligand' -> channel_bound'             [1e7]
\layout LyX-Code

  channel_bound'             -> channel_unbound' + ligand' [2e2]
\layout LyX-Code

  channel_bound'             -> channel_open'              [5e2]
\layout LyX-Code

  channel_open
\begin_inset ERT
status Collapsed

\layout Standard
{'}{'}
\end_inset 

 + ion'      -> channel_open
\begin_inset ERT
status Collapsed

\layout Standard
{'}{'}
\end_inset 

     + ion,  [4e7]
\layout LyX-Code

}
\layout Standard

Here, the ion travels in either direction just as easily since it pays no
 attention to the orientation of the channel.
 However, if there was a modest driving force, traveling in might be easier
 than traveling out, which would be reflected in the rates.
\layout LyX-Code

DEFINE_REACTIONS {
\layout LyX-Code

  channel_unbound' + ligand' -> channel_bound'             [1e7]
\layout LyX-Code

  channel_bound'             -> channel_unbound' + ligand' [2e2]
\layout LyX-Code

  channel_bound'             -> channel_open'              [5e2]
\layout LyX-Code

  channel_open' + ion'       -> channel_open'    + ion,    [4e8]
\layout LyX-Code

  channel_open' + ion,       -> channel_open'    + ion'    [1e8]
\layout LyX-Code

}
\layout Standard

In this case, the ion is four times as likely to travel from outside to
 inside as inside to outside.
\layout Subsection

Example bimolecular reaction
\layout Standard

Here's a complete mdl file that implements a simple bimolecular reaction
 that should achieve equilibrium at 482 molecules of each species.
\layout LyX-Code

time_step = 1.0e-6
\layout LyX-Code

\layout LyX-Code

TIME_STEP = time_step
\layout LyX-Code

TIME_STEP_MAX = time_step
\layout LyX-Code

ITERATIONS = 1e-2/time_step
\layout LyX-Code

EFFECTOR_GRID_DENSITY = 10000
\layout LyX-Code

INTERACTION_RADIUS = 0.001
\layout LyX-Code

\layout LyX-Code

PARTITION_X = [ [-0.1 TO 0.1 STEP 0.01] ]
\layout LyX-Code

PARTITION_Y = [ [-0.1 TO 0.1 STEP 0.01] ]
\layout LyX-Code

PARTITION_Z = [ [-0.1 TO 0.1 STEP 0.01] ]
\layout LyX-Code

\layout LyX-Code

DEFINE_MOLECULES
\layout LyX-Code

{
\layout LyX-Code

  A { D_3D = 100e-8 }
\layout LyX-Code

  B { D_3D = 100e-8 }
\layout LyX-Code

  C { D_3D = 100e-8 }
\layout LyX-Code

}
\layout LyX-Code

\layout LyX-Code

/* Your basic reversable binding reaction */
\layout LyX-Code

DEFINE_REACTIONS
\layout LyX-Code

{
\layout LyX-Code

  A + B -> C [1e7]
\layout LyX-Code

  C -> A + B [1e3]
\layout LyX-Code

}
\layout LyX-Code

\layout LyX-Code

small_box BOX
\layout LyX-Code

{
\layout LyX-Code

  CORNERS = [-0.1,-0.1,-0.1] , [0.1,0.1,0.1]
\layout LyX-Code

  /* REMOVE_ELEMENTS { TOP,LEFT } */  /* Could remove sides ...
 */
\layout LyX-Code

  /* REMOVE_ELEMENTS { INCLUDE_PATCH = [0.1,0,0] , [0.1,0.05,0.05] } /*...
 or patch*/
\layout LyX-Code

}
\layout LyX-Code

INSTANTIATE my_world OBJECT
\layout LyX-Code

{
\layout LyX-Code

  A_release CUBIC_RELEASE_SITE {
\layout LyX-Code

    LOCATION=[0,0,0]
\layout LyX-Code

    MOLECULE=A
\layout LyX-Code

    NUMBER_TO_RELEASE=482
\layout LyX-Code

    SITE_DIAMETER=0.196
\layout LyX-Code

  }
\layout LyX-Code

  B_release CUBIC_RELEASE_SITE {
\layout LyX-Code

    LOCATION=[0,0,0]
\layout LyX-Code

    MOLECULE=B
\layout LyX-Code

    NUMBER_TO_RELEASE=482
\layout LyX-Code

    SITE_DIAMETER=0.196
\layout LyX-Code

  }
\layout LyX-Code

  C_release CUBIC_RELEASE_SITE {
\layout LyX-Code

    LOCATION=[0,0,0]
\layout LyX-Code

    MOLECULE=C
\layout LyX-Code

    NUMBER_TO_RELEASE=482
\layout LyX-Code

    SITE_DIAMETER=0.196
\layout LyX-Code

  }
\layout LyX-Code

\layout LyX-Code

 my_box OBJECT small_box {}
\layout LyX-Code

}
\layout LyX-Code

\layout LyX-Code

REACTION_DATA_OUTPUT
\layout LyX-Code

{
\layout LyX-Code

  STEP = 1e-5
\layout LyX-Code

  { COUNT [A,WORLD] } => "eq_A.dat"
\layout LyX-Code

  { COUNT [B,WORLD] } => "eq_B.dat"
\layout LyX-Code

  { COUNT [C,WORLD] } => "eq_C.dat"
\layout LyX-Code

}
\layout Standard


\emph on 
!!
\emph default 
That's all, folks
\emph on 
!!
\layout LyX-Code

\the_end
