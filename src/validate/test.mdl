
dt = 0.4e-6
it = 2000
efg = 10000

n=100

TIME_STEP = dt
TIME_STEP_MAX = dt*1.01
ITERATIONS = it
EFFECTOR_GRID_DENSITY = efg
INTERACTION_RADIUS = 0.01
RADIAL_SUBDIVISIONS = 256
RADIAL_DIRECTIONS = 16384

DEFINE_MOLECULES {
  ACh {
    DIFFUSION_CONSTANT = 2.2e-6
  }
  Glu {
    DIFFUSION_CONSTANT = 2.1e-6
  }
  Glw {
    DIFFUSION_CONSTANT = 2e-6
  }
  AChR.R {
    DIFFUSION_CONSTANT_2D = 0
  }
  AChR.AR {
    DIFFUSION_CONSTANT_2D = 0
  }
  ACf {
    DIFFUSION_CONSTANT_2D = 0
  }
  ACe {
    DIFFUSION_CONSTANT_2D = 0
  }
  ACg {
    DIFFUSION_CONSTANT_2D = 0
  }
}

DEFINE_SURFACE_CLASSES {
  surf_a {
    TRANSPARENT = ACh
    MOLECULE_DENSITY {
      ACf' = 500
    }
  }
  surf_b {
    TRANSPARENT = Glu
    ABSORPTIVE = ACh
    MOLECULE_NUMBER {
      ACf' = 100
    }
  }
}

DEFINE_REACTIONS {
/*  ACh + Glu -> ACh + Glu + Glw [1e8] */
/*  ACh' + GENERIC_SURFACE, -> ACf, [1e8]
  Glu + ACf -> ACf + Glw [1e8]
  Glw' + GENERIC_SURFACE, -> ACg [1e7] */
/*  Glu' + AChR.R, -> Glu' + AChR.AR, [1e8] */
  AChR.R, -> ACf, [1e4] 
  Glu; -> Glw; [1e4] 
/*  Glw + AChR.AR -> Glw + AChR.R [1e8] */
/*  ACg -> ACe [1e4] */
}

DEFINE_RELEASE_PATTERN pat1 {
  DELAY = 0
  RELEASE_INTERVAL = 4.0e-3
  TRAIN_INTERVAL = 1
  TRAIN_DURATION = 20.0e-3
  NUMBER_OF_TRAINS = 1
}

DEFINE_RELEASE_PATTERN pat2 {
  DELAY = 1.5e-3
  RELEASE_INTERVAL = 3.0e-3
  TRAIN_INTERVAL = 1
  TRAIN_DURATION = 20.0e-3
  NUMBER_OF_TRAINS = 1
}

ACh_release_site CUBIC_RELEASE_SITE {
  LOCATION = [0,0,0]
  MOLECULE = ACh
  NUMBER_TO_RELEASE = n
  SITE_DIAMETER = 0.199999
  RELEASE_PATTERN = pat1
}

Glu_release_site CUBIC_RELEASE_SITE {
  LOCATION = [0,0,0]
  MOLECULE = Glu
  NUMBER_TO_RELEASE = n
  SITE_DIAMETER = 0.199999
  RELEASE_PATTERN = pat1
}

box BOX {
  CORNERS = [-0.1, -0.1, -0.1] , [0.1,0.1,0.1]
  DEFINE_SURFACE_REGIONS {
    reg1 {
      ELEMENT_LIST = [ALL_ELEMENTS]
/*
      ELEMENT_LIST = [TOP,BOTTOM]
      SURFACE_CLASS = surf_a
*/
      MOLECULE_DENSITY {
        AChR.R' = 5000
      }
    }
  }
}


/*
DEFINE_SURFACE_REGIONS {
  box[reg2] {
    ELEMENT_LIST = [LEFT,RIGHT]
    SURFACE_CLASS = surf_a
    MOLECULE_NUMBER {
      ACf' = 250
    }
  }
}


MODIFY_SURFACE_REGIONS {
  box[reg1] {
    SURFACE_CLASS = surf_a
    MOLECULE_DENSITY {
      ACf' = 2000
    }
  }
}
*/


poly POLYGON_LIST {
  VERTEX_LIST {
    [0,0,0]
    [0.363424,0,0]
    [0,0.363424,0]
    [0,0,0.363424]
  }
  ELEMENT_CONNECTIONS {
    [0,1,2]
    [1,2,3]
    [3,0,1]
    [0,2,3]
  }
}

INSTANTIATE foo OBJECT {
  ACh_release_site OBJECT ACh_release_site {}
  Glu_release_site OBJECT Glu_release_site {}
  box OBJECT box {} 
/*  poly OBJECT poly {} */ 
}

INCLUDE_FILE = "test_include.mdl"

/*
  printf("a = %g\n",a)
*/

VIZ_DATA_OUTPUT {
  MODE = DX
  STATE_VALUES {
    Glu = 1
    AChR.R = 2
/*
    foo = 1
*/
  }
  MOLECULE_FILE_PREFIX = "./viz/foo"
  OBJECT_FILE_PREFIXES {
    foo.box = "./viz/foo"
  }
  ITERATION_LIST = [0,1,10,100]
}
