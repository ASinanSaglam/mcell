TIME_STEP = 1e-6
ITERATIONS = 5000
EFFECTOR_GRID_DENSITY = 10000
PARTITION_X = [-0.01,0.3,0.7,1.01]
PARTITION_Y = [-0.01,0.3,0.7,1.01]
PARTITION_Z = [-0.01,0.3,0.7,1.01]

DEFINE_LIGAND A { DIFFUSION_CONSTANT = 2e-6 }

DEFINE_REACTION Rx
{
  B  [ >BA { 1e8 : +A , NEGATIVE_POLE } ]
  BA [ >B  { 3e2 : -A , NEGATIVE_POLE } ]
  REFERENCE_STATE B
  {
    A NUMBER_BOUND = 0
  }
}

box BOX {
  CORNERS = [0,0,0] , [1,1,1]
  FULLY_CLOSED = YES
  ADD_EFFECTOR
  {
    STATE = Rx.B
    DENSITY = 500
    ELEMENT = ALL_ELEMENTS
  }
}

INSTANTIATE world OBJECT
{
  release_site SPHERICAL_RELEASE_SITE
  {
    LOCATION = [0.5,0.5,0,5]
    LIGAND = A
    NUMBER_TO_RELEASE = 1000
    SITE_DIAMETER = 0.000001
  }
  
  effectors OBJECT box {}
}

REACTION_DATA_OUTPUT
{
  STEP = 1e-6
  { COUNT[Rx.B,WORLD,FOR_EACH_TIME_STEP] } => "B.txt"
  { COUNT[Rx.BA,WORLD,FOR_EACH_TIME_STEP] } => "BA.txt"
  { COUNT[A,world,FOR_EACH_TIME_STEP] } => "A.txt"
}
  